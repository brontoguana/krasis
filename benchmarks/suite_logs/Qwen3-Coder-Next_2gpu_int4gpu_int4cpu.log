
[1m[36m‚ñ∏ Loading model weights[0m

[1m[36m‚ñ∏ Loading GPU weights[0m

[1m[36m‚ñ∏ Loading CPU expert weights[0m

[1m[36m‚ñ∏ Initializing GPU prefill managers[0m

[1m[36m‚ñ∏ Loading cached heatmap[0m

[1m[36m‚ñ∏ Warming up CUDA runtime[0m

[1m[36m‚ñ∏ Allocating HCS expert cache[0m

[1m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  KRASIS BENCHMARK
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê[0m

[1m[36m‚ñ∏ Collecting system info[0m
  Model:    [1mQwen3-Coder-Next[0m
  GPUs:     3x NVIDIA RTX 2000 Ada Generation
  Strategy: gpu_decode (hot_cached_static)

[1m[36m‚ñ∏ Loading benchmark prompts[0m
  Prefill: 10,000 tokens
  Decode:  24 tokens

[1m[36m‚ñ∏ Warmup (2 short generations)[0m
  Warmup: 2 short generations...
  Warmup complete.

[1m[36m‚ñ∏ Running prefill benchmark (10,000 tokens, 3 runs)[0m
  Run 1: 818.8 tok/s, TTFT=12.21s
  Run 2: 820.9 tok/s, TTFT=12.18s
  Run 3: 818.9 tok/s, TTFT=12.21s
  [1mAverage: 819.5 tok/s, TTFT=12.20s[0m

[1m[36m‚ñ∏ Running decode benchmark (64 tokens, 3 runs)[0m
  Run 1: 7.94 tok/s (125.9ms/tok)
  Run 2: 7.95 tok/s (125.8ms/tok)
  Run 3: 7.93 tok/s (126.1ms/tok)
  [1mAverage: 7.94 tok/s (125.9ms/tok)[0m

[1m[36m‚ñ∏ Writing results[0m

[1m‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  BENCHMARK COMPLETE
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[0m
  Prefill: [32m[1m819.5 tok/s[0m  TTFT=12.20s
  Decode:  [32m[1m7.94 tok/s[0m  (125.9ms/tok)
  Log:     [2mbenchmarks/Qwen3-Coder-Next_native_1gpu_int4gpu_int4cpu.log[0m



--- STDERR ---
2026-02-20 09:50:35,476 krasis.server INFO Logging to /home/main/Documents/Claude/krasis/krasis.log
2026-02-20 09:50:35,476 krasis.server INFO HCS strategy: PP=1, 2 GPUs available
2026-02-20 09:50:35,477 krasis.model INFO KrasisModel: 48 layers, PP=[48], 1 GPUs, attn=flashinfer, hybrid=12 full + 36 linear
2026-02-20 09:50:35,521 krasis.server INFO ‚îÄ‚îÄ Loading model weights ‚îÄ‚îÄ
2026-02-20 09:50:35,521 krasis.model INFO RAM budget: experts=39.9 GB, overhead=20.0 GB, total=59.9 GB needed | system: 995.5 GB total, 956.1 GB available
2026-02-20 09:50:35,521 krasis.model INFO RAM budget OK: 59.9 GB needed, 935.6 GB headroom
2026-02-20 09:50:35,522 krasis.model INFO RAM watchdog started: will exit if < 5.0% free
2026-02-20 09:50:35,522 krasis.model INFO Phase 1: Loading GPU weights (streaming INT8)...
2026-02-20 09:50:35,689 krasis.model INFO Loading full base model to primary device cuda:0...
2026-02-20 09:50:35,689 krasis.weight_loader INFO Loading embedding: model.embed_tokens.weight
2026-02-20 09:50:35,935 krasis.weight_loader INFO Layer 0 loaded in 0.2s (GPU alloc: 631 MB, moe=True, type=linear_attention)
2026-02-20 09:50:36,090 krasis.weight_loader INFO Layer 1 loaded in 0.1s (GPU alloc: 672 MB, moe=True, type=linear_attention)
2026-02-20 09:50:36,234 krasis.weight_loader INFO Layer 2 loaded in 0.1s (GPU alloc: 714 MB, moe=True, type=linear_attention)
2026-02-20 09:50:36,347 krasis.weight_loader INFO Layer 3 loaded in 0.1s (GPU alloc: 749 MB, moe=True, type=full_attention)
2026-02-20 09:50:36,348 krasis.attention INFO Layer 3: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:36,500 krasis.weight_loader INFO Layer 4 loaded in 0.1s (GPU alloc: 926 MB, moe=True, type=linear_attention)
2026-02-20 09:50:36,644 krasis.weight_loader INFO Layer 5 loaded in 0.1s (GPU alloc: 967 MB, moe=True, type=linear_attention)
2026-02-20 09:50:36,786 krasis.weight_loader INFO Layer 6 loaded in 0.1s (GPU alloc: 1009 MB, moe=True, type=linear_attention)
2026-02-20 09:50:36,898 krasis.weight_loader INFO Layer 7 loaded in 0.1s (GPU alloc: 1044 MB, moe=True, type=full_attention)
2026-02-20 09:50:36,898 krasis.attention INFO Layer 7: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:37,050 krasis.weight_loader INFO Layer 8 loaded in 0.1s (GPU alloc: 1093 MB, moe=True, type=linear_attention)
2026-02-20 09:50:37,194 krasis.weight_loader INFO Layer 9 loaded in 0.1s (GPU alloc: 1134 MB, moe=True, type=linear_attention)
2026-02-20 09:50:37,337 krasis.weight_loader INFO Layer 10 loaded in 0.1s (GPU alloc: 1175 MB, moe=True, type=linear_attention)
2026-02-20 09:50:37,452 krasis.weight_loader INFO Layer 11 loaded in 0.1s (GPU alloc: 1210 MB, moe=True, type=full_attention)
2026-02-20 09:50:37,452 krasis.attention INFO Layer 11: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:37,603 krasis.weight_loader INFO Layer 12 loaded in 0.1s (GPU alloc: 1260 MB, moe=True, type=linear_attention)
2026-02-20 09:50:37,746 krasis.weight_loader INFO Layer 13 loaded in 0.1s (GPU alloc: 1301 MB, moe=True, type=linear_attention)
2026-02-20 09:50:37,890 krasis.weight_loader INFO Layer 14 loaded in 0.1s (GPU alloc: 1342 MB, moe=True, type=linear_attention)
2026-02-20 09:50:38,006 krasis.weight_loader INFO Layer 15 loaded in 0.1s (GPU alloc: 1377 MB, moe=True, type=full_attention)
2026-02-20 09:50:38,006 krasis.attention INFO Layer 15: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:38,158 krasis.weight_loader INFO Layer 16 loaded in 0.1s (GPU alloc: 1427 MB, moe=True, type=linear_attention)
2026-02-20 09:50:38,303 krasis.weight_loader INFO Layer 17 loaded in 0.1s (GPU alloc: 1468 MB, moe=True, type=linear_attention)
2026-02-20 09:50:38,445 krasis.weight_loader INFO Layer 18 loaded in 0.1s (GPU alloc: 1509 MB, moe=True, type=linear_attention)
2026-02-20 09:50:38,560 krasis.weight_loader INFO Layer 19 loaded in 0.1s (GPU alloc: 1544 MB, moe=True, type=full_attention)
2026-02-20 09:50:38,560 krasis.attention INFO Layer 19: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:38,713 krasis.weight_loader INFO Layer 20 loaded in 0.1s (GPU alloc: 1594 MB, moe=True, type=linear_attention)
2026-02-20 09:50:38,858 krasis.weight_loader INFO Layer 21 loaded in 0.1s (GPU alloc: 1635 MB, moe=True, type=linear_attention)
2026-02-20 09:50:39,002 krasis.weight_loader INFO Layer 22 loaded in 0.1s (GPU alloc: 1676 MB, moe=True, type=linear_attention)
2026-02-20 09:50:39,117 krasis.weight_loader INFO Layer 23 loaded in 0.1s (GPU alloc: 1711 MB, moe=True, type=full_attention)
2026-02-20 09:50:39,117 krasis.attention INFO Layer 23: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:39,267 krasis.weight_loader INFO Layer 24 loaded in 0.1s (GPU alloc: 1760 MB, moe=True, type=linear_attention)
2026-02-20 09:50:39,412 krasis.weight_loader INFO Layer 25 loaded in 0.1s (GPU alloc: 1802 MB, moe=True, type=linear_attention)
2026-02-20 09:50:39,557 krasis.weight_loader INFO Layer 26 loaded in 0.1s (GPU alloc: 1843 MB, moe=True, type=linear_attention)
2026-02-20 09:50:39,670 krasis.weight_loader INFO Layer 27 loaded in 0.1s (GPU alloc: 1878 MB, moe=True, type=full_attention)
2026-02-20 09:50:39,670 krasis.attention INFO Layer 27: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:39,821 krasis.weight_loader INFO Layer 28 loaded in 0.1s (GPU alloc: 1927 MB, moe=True, type=linear_attention)
2026-02-20 09:50:39,966 krasis.weight_loader INFO Layer 29 loaded in 0.1s (GPU alloc: 1969 MB, moe=True, type=linear_attention)
2026-02-20 09:50:40,108 krasis.weight_loader INFO Layer 30 loaded in 0.1s (GPU alloc: 2010 MB, moe=True, type=linear_attention)
2026-02-20 09:50:40,223 krasis.weight_loader INFO Layer 31 loaded in 0.1s (GPU alloc: 2045 MB, moe=True, type=full_attention)
2026-02-20 09:50:40,223 krasis.attention INFO Layer 31: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:40,375 krasis.weight_loader INFO Layer 32 loaded in 0.1s (GPU alloc: 2094 MB, moe=True, type=linear_attention)
2026-02-20 09:50:40,521 krasis.weight_loader INFO Layer 33 loaded in 0.1s (GPU alloc: 2135 MB, moe=True, type=linear_attention)
2026-02-20 09:50:40,666 krasis.weight_loader INFO Layer 34 loaded in 0.1s (GPU alloc: 2177 MB, moe=True, type=linear_attention)
2026-02-20 09:50:40,780 krasis.weight_loader INFO Layer 35 loaded in 0.1s (GPU alloc: 2212 MB, moe=True, type=full_attention)
2026-02-20 09:50:40,780 krasis.attention INFO Layer 35: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:40,932 krasis.weight_loader INFO Layer 36 loaded in 0.1s (GPU alloc: 2261 MB, moe=True, type=linear_attention)
2026-02-20 09:50:41,076 krasis.weight_loader INFO Layer 37 loaded in 0.1s (GPU alloc: 2302 MB, moe=True, type=linear_attention)
2026-02-20 09:50:41,220 krasis.weight_loader INFO Layer 38 loaded in 0.1s (GPU alloc: 2344 MB, moe=True, type=linear_attention)
2026-02-20 09:50:41,337 krasis.weight_loader INFO Layer 39 loaded in 0.1s (GPU alloc: 2379 MB, moe=True, type=full_attention)
2026-02-20 09:50:41,337 krasis.attention INFO Layer 39: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:41,489 krasis.weight_loader INFO Layer 40 loaded in 0.1s (GPU alloc: 2428 MB, moe=True, type=linear_attention)
2026-02-20 09:50:41,631 krasis.weight_loader INFO Layer 41 loaded in 0.1s (GPU alloc: 2469 MB, moe=True, type=linear_attention)
2026-02-20 09:50:41,775 krasis.weight_loader INFO Layer 42 loaded in 0.1s (GPU alloc: 2510 MB, moe=True, type=linear_attention)
2026-02-20 09:50:41,891 krasis.weight_loader INFO Layer 43 loaded in 0.1s (GPU alloc: 2545 MB, moe=True, type=full_attention)
2026-02-20 09:50:41,892 krasis.attention INFO Layer 43: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:42,043 krasis.weight_loader INFO Layer 44 loaded in 0.1s (GPU alloc: 2595 MB, moe=True, type=linear_attention)
2026-02-20 09:50:42,187 krasis.weight_loader INFO Layer 45 loaded in 0.1s (GPU alloc: 2636 MB, moe=True, type=linear_attention)
2026-02-20 09:50:42,331 krasis.weight_loader INFO Layer 46 loaded in 0.1s (GPU alloc: 2677 MB, moe=True, type=linear_attention)
2026-02-20 09:50:42,445 krasis.weight_loader INFO Layer 47 loaded in 0.1s (GPU alloc: 2712 MB, moe=True, type=full_attention)
2026-02-20 09:50:42,445 krasis.attention INFO Layer 47: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:42,454 krasis.weight_loader INFO Loading final norm: model.norm.weight
2026-02-20 09:50:42,455 krasis.weight_loader INFO Loading LM head: lm_head.weight (precision=int8)
2026-02-20 09:50:43,524 krasis.model INFO Copying full base model weights to cuda:1...
2026-02-20 09:50:45,663 krasis.attention INFO Layer 3: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:46,403 krasis.attention INFO Layer 7: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:47,291 krasis.attention INFO Layer 11: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:47,983 krasis.attention INFO Layer 15: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:52,227 krasis.attention INFO Layer 19: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:50:56,767 krasis.attention INFO Layer 23: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:51:01,308 krasis.attention INFO Layer 27: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:51:05,898 krasis.attention INFO Layer 31: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:51:10,340 krasis.attention INFO Layer 35: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:51:14,880 krasis.attention INFO Layer 39: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:51:19,421 krasis.attention INFO Layer 43: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:51:23,961 krasis.attention INFO Layer 47: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-20 09:51:24,159 krasis.model INFO Full base model copied to cuda:1 in 40.6s (3021 MB allocated)
2026-02-20 09:51:24,397 krasis.model INFO GPU0: 3021 MB allocated
2026-02-20 09:51:24,397 krasis.model INFO GPU weights loaded in 48.9s
2026-02-20 09:51:24,397 krasis.model INFO Phase 2: Loading CPU expert weights (Krasis INT4)...
2026-02-20 09:51:24,397 krasis.model INFO shared_expert_gate detected ‚Äî Rust engine will skip shared experts (handled on GPU)
2026-02-20 09:52:17,062 krasis.model INFO Krasis engine: 48 MoE layers, 512 experts, hidden=2048
2026-02-20 09:52:17,152 krasis.model INFO Routing weights sent to Rust engine (48 MoE layers)
2026-02-20 09:52:17,153 krasis.model INFO CPU experts loaded in 52.8s
2026-02-20 09:52:17,153 krasis.model WARNING RAM estimate deviation: estimated 39.9 GB, actual VmRSS 76.2 GB (91% off) ‚Äî estimates may need recalibration
2026-02-20 09:52:17,153 krasis.gpu_prefill INFO GpuPrefillManager(rank 0/2): expert_slice=[0, 256), local_count=256
2026-02-20 09:52:17,153 krasis.gpu_prefill INFO GPU prefill group_size=128
2026-02-20 09:52:17,153 krasis.gpu_prefill INFO Auto chunk_size: 512 experts (1.6 MB each, 5260.6 MB budget of 13413.6 MB free)
2026-02-20 09:52:17,153 krasis.gpu_prefill INFO Hot-cached-static mode: hot experts on GPU (static), cold on CPU (parallel)
2026-02-20 09:52:17,153 krasis.gpu_prefill INFO GpuPrefillManager(engine): experts=512, hidden=2048, intermediate=512, chunk_size=512, num_chunks=1, shared=1, scale=1.000, num_bits=4, prefill_mode=hot_cached_static, expert_divisor=-3
2026-02-20 09:52:17,153 krasis.model INFO GPU prefill manager created for cuda:0 (rank 0/2)
2026-02-20 09:52:17,154 krasis.gpu_prefill INFO GpuPrefillManager(rank 1/2): expert_slice=[256, 512), local_count=256
2026-02-20 09:52:17,154 krasis.gpu_prefill INFO GPU prefill group_size=128
2026-02-20 09:52:17,154 krasis.gpu_prefill INFO Auto chunk_size: 512 experts (1.6 MB each, 5260.6 MB budget of 13413.6 MB free)
2026-02-20 09:52:17,154 krasis.gpu_prefill INFO Hot-cached-static mode: hot experts on GPU (static), cold on CPU (parallel)
2026-02-20 09:52:17,154 krasis.gpu_prefill INFO GpuPrefillManager(engine): experts=512, hidden=2048, intermediate=512, chunk_size=512, num_chunks=1, shared=1, scale=1.000, num_bits=4, prefill_mode=hot_cached_static, expert_divisor=-3
2026-02-20 09:52:17,154 krasis.model INFO GPU prefill manager created for cuda:1 (rank 1/2)
2026-02-20 09:52:17,154 krasis.gpu_prefill INFO Engine path: Marlin-native DMA copy (zero conversion, zero RAM cache)
2026-02-20 09:52:17,154 krasis.gpu_prefill INFO Engine path: Marlin-native DMA copy (zero conversion, zero RAM cache)
2026-02-20 09:52:17,154 krasis.model INFO GPU prefill: 2 managers, threshold=1 tokens
2026-02-20 09:52:17,154 krasis.kv_cache INFO KV cache: 2000 MB ‚Üí 10666 pages (170.7K tokens)
2026-02-20 09:52:17,157 krasis.kv_cache INFO KV cache allocated: 12 layers √ó 10666 pages √ó 16 tokens = 2000 MB (gqa, gqa-split)
2026-02-20 09:52:17,158 krasis.model INFO Hybrid model: 12 full attention layers (KV cache), 36 linear attention layers
2026-02-20 09:52:17,248 krasis.model INFO CPU Hub initialized for 2 GPUs
2026-02-20 09:52:17,531 krasis.tokenizer INFO Tokenizer loaded: vocab=151643, eos=151645, bos=-1
2026-02-20 09:52:17,531 krasis.model INFO Model fully loaded in 102.0s
2026-02-20 09:52:17,534 krasis.server INFO ‚îÄ‚îÄ Loading cached heatmap ‚îÄ‚îÄ
2026-02-20 09:52:17,535 krasis.server INFO Using cached heatmap: /home/main/.krasis/models/Qwen3-Coder-Next/.krasis_cache/auto_heatmap.json
2026-02-20 09:52:17,535 krasis.server INFO ‚îÄ‚îÄ Warming up CUDA runtime ‚îÄ‚îÄ
2026-02-20 09:52:17,536 krasis.model INFO Warming up CUDA runtime on all devices: ['cuda:0', 'cuda:1']
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.cudart module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.runtime module instead.
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.nvrtc module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.nvrtc module instead.
2026-02-20 09:52:21,747 krasis.model WARNING CUDA warmup (Triton/Marlin) on cuda:1 failed: w_packed shape torch.Size([1024, 256]) != (1024, 64)
2026-02-20 09:52:21,749 krasis.linear_attention INFO Compiled linear attention chunk step (default/Inductor mode)
2026-02-20 09:52:22,100 krasis.linear_attention INFO Linear attention torch.compile warmup complete on cuda:0
2026-02-20 09:52:22,382 krasis.model INFO CUDA runtime warmup on cuda:0 complete: 46 MB consumed (11316 MB free before ‚Üí 11270 MB free after)
2026-02-20 09:52:22,383 krasis.model INFO CUDA runtime warmup on cuda:1 complete: -2 MB consumed (13414 MB free before ‚Üí 13416 MB free after)
2026-02-20 09:52:22,383 krasis.server INFO ‚îÄ‚îÄ Allocating HCS expert cache ‚îÄ‚îÄ
2026-02-20 09:52:22,383 krasis.server INFO Unified HCS: initializing with devices: ['cuda:0', 'cuda:1']
2026-02-20 09:52:22,440 krasis.server INFO Test prompt: 10000 tokens
2026-02-20 09:52:22,723 krasis.gpu_prefill INFO HCS state cleared.
2026-02-20 09:52:22,735 krasis.gpu_prefill INFO Loaded heatmap from /home/main/.krasis/models/Qwen3-Coder-Next/.krasis_cache/auto_heatmap.json: 15923 entries
2026-02-20 09:52:22,739 krasis.gpu_prefill INFO HCS unified VRAM budget: 1 devices, 1.6 MB/expert, per-device max experts: {'cuda:0': 2776}, total max: 2776
2026-02-20 09:52:22,744 krasis.gpu_prefill INFO HCS uniform allocation: 57 experts/layer across 48 layers = 2736 total
2026-02-20 09:52:22,745 krasis.gpu_prefill INFO HCS assignment check: device 0 (cuda:0) ‚Üí 2736 experts (budget: 2776)
2026-02-20 09:52:22,745 krasis.gpu_prefill INFO HCS pre-load: cuda:0 allocated=5029 MB, free=10764 MB
2026-02-20 09:52:22,871 krasis.gpu_prefill INFO HCS load L0: total=92 MB | dev0: alloc=5118MB free=10654MB loaded=92MB(57exp)
2026-02-20 09:52:23,486 krasis.gpu_prefill INFO HCS load L6: total=647 MB | dev0: alloc=5654MB free=10120MB loaded=647MB(399exp)
2026-02-20 09:52:24,074 krasis.gpu_prefill INFO HCS load L12: total=1202 MB | dev0: alloc=6189MB free=9566MB loaded=1202MB(741exp)
2026-02-20 09:52:24,664 krasis.gpu_prefill INFO HCS load L18: total=1757 MB | dev0: alloc=6724MB free=9032MB loaded=1757MB(1083exp)
2026-02-20 09:52:25,256 krasis.gpu_prefill INFO HCS load L24: total=2311 MB | dev0: alloc=7259MB free=8478MB loaded=2311MB(1425exp)
2026-02-20 09:52:25,846 krasis.gpu_prefill INFO HCS load L30: total=2866 MB | dev0: alloc=7795MB free=7944MB loaded=2866MB(1767exp)
2026-02-20 09:52:26,437 krasis.gpu_prefill INFO HCS load L36: total=3421 MB | dev0: alloc=8330MB free=7390MB loaded=3421MB(2109exp)
2026-02-20 09:52:27,026 krasis.gpu_prefill INFO HCS load L42: total=3976 MB | dev0: alloc=8865MB free=6856MB loaded=3976MB(2451exp)
2026-02-20 09:52:27,517 krasis.gpu_prefill INFO HCS load L47: total=4438 MB | dev0: alloc=9311MB free=6392MB loaded=4438MB(2736exp)
2026-02-20 09:52:27,861 krasis.gpu_prefill INFO hot_cached_static initialized: 2736 experts across 1 devices, 4437.8 MB in 4.77s. Counts: {'cuda:0': 2736}
2026-02-20 09:52:27,927 krasis.gpu_prefill INFO CUDA graphs captured: 48 MoE layers
2026-02-20 09:52:27,935 krasis.server INFO HCS calibration: 2736 experts, 5434 MB consumed (free: 10764 ‚Üí 5330 MB)
2026-02-20 09:52:27,938 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:52:27,939 krasis.gpu_prefill INFO Pre-allocating pinned DMA buffers: 415.2 MB (w13p=268.4, w13s=8.4, w2p=134.2, w2s=4.2)
2026-02-20 09:52:27,939 krasis.gpu_prefill INFO Pre-allocating pinned DMA buffers: 415.2 MB (w13p=268.4, w13s=8.4, w2p=134.2, w2s=4.2)
2026-02-20 09:52:28,502 krasis.gpu_prefill INFO Pinned DMA buffers allocated: 415.2 MB in 0.6s (one-time cost)
2026-02-20 09:52:28,502 krasis.gpu_prefill INFO Pinned DMA buffers allocated: 415.2 MB in 0.6s (one-time cost)
2026-02-20 09:52:28,580 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3583.7 MB)
2026-02-20 09:52:28,580 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10221.9 MB)
2026-02-20 09:52:29,211 krasis.model WARNING GPU P2P transfer broken ‚Äî using CPU bounce for cross-device transfers
2026-02-20 09:52:29,488 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10358.8 MB)
2026-02-20 09:52:29,489 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:29,837 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10368.5 MB)
2026-02-20 09:52:29,837 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:30,187 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10379.2 MB)
2026-02-20 09:52:30,189 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:30,514 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10389.0 MB)
2026-02-20 09:52:30,516 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:30,864 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10400.7 MB)
2026-02-20 09:52:30,866 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:31,213 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10411.4 MB)
2026-02-20 09:52:31,216 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:31,566 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10421.5 MB)
2026-02-20 09:52:31,568 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:31,859 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10431.4 MB)
2026-02-20 09:52:31,862 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:32,213 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10443.0 MB)
2026-02-20 09:52:32,214 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:32,562 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10452.7 MB)
2026-02-20 09:52:32,565 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:32,914 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10462.4 MB)
2026-02-20 09:52:32,915 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:33,204 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10472.2 MB)
2026-02-20 09:52:33,205 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:33,553 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10482.9 MB)
2026-02-20 09:52:33,556 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:33,905 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10493.6 MB)
2026-02-20 09:52:33,907 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:34,256 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10505.3 MB)
2026-02-20 09:52:34,259 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:34,548 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10515.1 MB)
2026-02-20 09:52:34,549 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:34,896 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10523.8 MB)
2026-02-20 09:52:34,896 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:35,245 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10536.4 MB)
2026-02-20 09:52:35,246 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:35,594 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10538.1 MB)
2026-02-20 09:52:35,596 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:35,887 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10547.4 MB)
2026-02-20 09:52:35,889 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:36,238 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10559.1 MB)
2026-02-20 09:52:36,238 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:36,585 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10558.8 MB)
2026-02-20 09:52:36,586 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:36,930 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10563.4 MB)
2026-02-20 09:52:36,930 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:37,215 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10572.7 MB)
2026-02-20 09:52:37,216 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:37,563 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10583.4 MB)
2026-02-20 09:52:37,564 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:37,913 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10585.1 MB)
2026-02-20 09:52:37,914 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:38,265 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10588.2 MB)
2026-02-20 09:52:38,266 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:38,553 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10597.5 MB)
2026-02-20 09:52:38,553 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:38,902 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10608.2 MB)
2026-02-20 09:52:38,902 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:39,250 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10610.9 MB)
2026-02-20 09:52:39,251 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:39,601 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10611.1 MB)
2026-02-20 09:52:39,602 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:39,891 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10623.3 MB)
2026-02-20 09:52:39,891 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:40,239 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10633.0 MB)
2026-02-20 09:52:40,240 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:40,592 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10634.7 MB)
2026-02-20 09:52:40,592 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:40,941 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10637.3 MB)
2026-02-20 09:52:40,941 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:41,233 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10647.6 MB)
2026-02-20 09:52:41,233 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:41,582 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10658.3 MB)
2026-02-20 09:52:41,582 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:41,936 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10660.0 MB)
2026-02-20 09:52:41,939 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:42,289 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10662.1 MB)
2026-02-20 09:52:42,290 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:42,580 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10662.4 MB)
2026-02-20 09:52:42,581 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:42,933 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10674.6 MB)
2026-02-20 09:52:42,934 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:43,284 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10676.3 MB)
2026-02-20 09:52:43,284 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:43,634 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10678.4 MB)
2026-02-20 09:52:43,635 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:43,925 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10679.7 MB)
2026-02-20 09:52:43,928 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:44,276 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:44,278 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10690.9 MB)
2026-02-20 09:52:44,629 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10691.6 MB)
2026-02-20 09:52:44,632 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:44,980 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 10694.7 MB)
2026-02-20 09:52:44,984 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:45,436 krasis.gpu_prefill INFO GPU validation PASS: 2736 experts, 5330 MB free after load, inference cost 1796 MB (peak 11441 MB, baseline 9645 MB)
2026-02-20 09:52:45,436 krasis.server INFO Inference cost on cuda:0: 1796 MB (transient)
2026-02-20 09:52:45,436 krasis.server INFO Per-expert cost: 2082588 bytes total (1622016 data + 460572 overhead), HCS overhead: 1201 MB (workspace + g_idx/sort_idx)
2026-02-20 09:52:45,847 krasis.gpu_prefill INFO HCS state cleared.
2026-02-20 09:52:45,847 krasis.server INFO Inference cost on cuda:1: 3021 MB (base model only, no compute)
2026-02-20 09:52:45,847 krasis.server INFO GPU cuda:0: 9466 MB free, reserved=2308 MB (inference=1796 + margin=512), budget=5574 MB (3604 max experts)
2026-02-20 09:52:45,848 krasis.server INFO GPU cuda:1: 12792 MB free, budget=12280 MB (7938 max experts)
2026-02-20 09:52:46,130 krasis.gpu_prefill INFO HCS state cleared.
2026-02-20 09:52:46,141 krasis.gpu_prefill INFO Loaded heatmap from /home/main/.krasis/models/Qwen3-Coder-Next/.krasis_cache/auto_heatmap.json: 15923 entries
2026-02-20 09:52:46,145 krasis.gpu_prefill INFO HCS unified VRAM budget: 1 devices, 1.6 MB/expert, per-device max experts: {'cuda:0': 3603}, total max: 3603
2026-02-20 09:52:46,147 krasis.gpu_prefill INFO HCS assignment check: device 0 (cuda:0) ‚Üí 3603 experts (budget: 3603)
2026-02-20 09:52:46,147 krasis.gpu_prefill INFO HCS pre-load: cuda:0 allocated=5362 MB, free=9466 MB
2026-02-20 09:52:46,358 krasis.gpu_prefill INFO HCS load L0: total=156 MB | dev0: alloc=5511MB free=9320MB loaded=156MB(96exp)
2026-02-20 09:52:47,413 krasis.gpu_prefill INFO HCS load L6: total=908 MB | dev0: alloc=6234MB free=8616MB loaded=908MB(560exp)
2026-02-20 09:52:48,501 krasis.gpu_prefill INFO HCS load L12: total=1682 MB | dev0: alloc=6976MB free=7876MB loaded=1682MB(1037exp)
2026-02-20 09:52:49,560 krasis.gpu_prefill INFO HCS load L18: total=2436 MB | dev0: alloc=7701MB free=7150MB loaded=2436MB(1502exp)
2026-02-20 09:52:50,630 krasis.gpu_prefill INFO HCS load L24: total=3197 MB | dev0: alloc=8432MB free=6420MB loaded=3197MB(1971exp)
2026-02-20 09:52:51,717 krasis.gpu_prefill INFO HCS load L30: total=3966 MB | dev0: alloc=9173MB free=5680MB loaded=3966MB(2445exp)
2026-02-20 09:52:52,713 krasis.gpu_prefill INFO HCS load L36: total=4670 MB | dev0: alloc=9852MB free=5000MB loaded=4670MB(2879exp)
2026-02-20 09:52:53,585 krasis.gpu_prefill INFO HCS load L42: total=5328 MB | dev0: alloc=10485MB free=4362MB loaded=5328MB(3285exp)
2026-02-20 09:52:54,255 krasis.gpu_prefill INFO HCS load L47: total=5844 MB | dev0: alloc=10984MB free=3874MB loaded=5844MB(3603exp)
2026-02-20 09:52:54,576 krasis.gpu_prefill INFO hot_cached_static initialized: 3603 experts across 1 devices, 5844.1 MB in 8.11s. Counts: {'cuda:0': 3603}
2026-02-20 09:52:54,640 krasis.gpu_prefill INFO CUDA graphs captured: 48 MoE layers
2026-02-20 09:52:54,654 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:52:54,733 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11898.0 MB)
2026-02-20 09:52:54,733 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3583.7 MB)
2026-02-20 09:52:55,080 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12025.9 MB)
2026-02-20 09:52:55,080 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:55,423 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12027.0 MB)
2026-02-20 09:52:55,426 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:55,770 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12029.2 MB)
2026-02-20 09:52:55,770 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:56,056 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12029.2 MB)
2026-02-20 09:52:56,056 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:56,399 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12032.4 MB)
2026-02-20 09:52:56,399 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:56,743 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12034.5 MB)
2026-02-20 09:52:56,743 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:57,090 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12036.2 MB)
2026-02-20 09:52:57,090 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:57,376 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12036.2 MB)
2026-02-20 09:52:57,376 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:57,721 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12039.3 MB)
2026-02-20 09:52:57,721 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:58,065 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12040.5 MB)
2026-02-20 09:52:58,067 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:58,412 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12041.7 MB)
2026-02-20 09:52:58,413 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:58,698 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12041.7 MB)
2026-02-20 09:52:58,698 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:59,041 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12044.8 MB)
2026-02-20 09:52:59,041 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:59,386 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12046.0 MB)
2026-02-20 09:52:59,386 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:52:59,732 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12049.2 MB)
2026-02-20 09:52:59,732 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:00,018 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12049.2 MB)
2026-02-20 09:53:00,019 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:00,361 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12049.4 MB)
2026-02-20 09:53:00,362 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:00,707 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12053.5 MB)
2026-02-20 09:53:00,707 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:01,052 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12055.7 MB)
2026-02-20 09:53:01,053 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:01,339 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12054.7 MB)
2026-02-20 09:53:01,340 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:01,686 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12057.8 MB)
2026-02-20 09:53:01,686 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:02,029 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12058.0 MB)
2026-02-20 09:53:02,029 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:02,372 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12062.6 MB)
2026-02-20 09:53:02,372 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:02,659 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12061.7 MB)
2026-02-20 09:53:02,660 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:03,005 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12063.8 MB)
2026-02-20 09:53:03,005 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:03,351 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12066.0 MB)
2026-02-20 09:53:03,353 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:03,700 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12069.1 MB)
2026-02-20 09:53:03,700 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:03,989 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12067.2 MB)
2026-02-20 09:53:03,989 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:04,336 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12071.3 MB)
2026-02-20 09:53:04,337 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:04,682 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12072.5 MB)
2026-02-20 09:53:04,682 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:05,027 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12075.6 MB)
2026-02-20 09:53:05,027 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:05,318 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12074.6 MB)
2026-02-20 09:53:05,319 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:05,666 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12076.8 MB)
2026-02-20 09:53:05,666 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:06,011 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12079.0 MB)
2026-02-20 09:53:06,011 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:06,357 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12081.6 MB)
2026-02-20 09:53:06,357 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:06,645 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12082.6 MB)
2026-02-20 09:53:06,645 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:06,992 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12083.8 MB)
2026-02-20 09:53:06,992 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:07,338 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:07,339 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12085.9 MB)
2026-02-20 09:53:07,686 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12088.1 MB)
2026-02-20 09:53:07,689 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:07,981 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12087.1 MB)
2026-02-20 09:53:07,982 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:08,328 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12090.3 MB)
2026-02-20 09:53:08,330 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:08,675 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12091.4 MB)
2026-02-20 09:53:08,678 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:09,027 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12094.6 MB)
2026-02-20 09:53:09,029 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:09,316 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12094.6 MB)
2026-02-20 09:53:09,318 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:09,665 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12096.7 MB)
2026-02-20 09:53:09,667 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:10,014 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12098.9 MB)
2026-02-20 09:53:10,016 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:10,360 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12100.1 MB)
2026-02-20 09:53:10,364 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3626.0 MB)
2026-02-20 09:53:10,768 krasis.gpu_prefill INFO GPU validation PASS: 3603 experts, 2816 MB free after load, inference cost 1799 MB (peak 12784 MB, baseline 10985 MB)
2026-02-20 09:53:10,768 krasis.server INFO HCS ready: 3603 experts across 2 GPUs, margin=1017 MB (free=2816, cost=1799). Counts: {'cuda:0': 3603}
2026-02-20 09:53:10,923 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:53:10,923 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-20 09:53:11,011 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 11856.0 MB)
2026-02-20 09:53:11,014 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 3583.7 MB)
2026-02-20 09:53:16,496 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:53:16,497 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-20 09:53:16,574 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11873.0 MB)
2026-02-20 09:53:16,578 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3583.7 MB)
2026-02-20 09:53:21,453 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:53:21,453 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-20 09:53:21,531 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11915.0 MB)
2026-02-20 09:53:21,534 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3583.7 MB)
2026-02-20 09:53:33,651 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:53:33,651 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-20 09:53:33,729 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11915.0 MB)
2026-02-20 09:53:33,732 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3583.7 MB)
2026-02-20 09:53:45,833 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:53:45,833 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-20 09:53:45,912 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11915.0 MB)
2026-02-20 09:53:45,914 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3583.7 MB)
2026-02-20 09:53:58,044 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:53:58,044 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-20 09:53:58,123 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11873.0 MB)
2026-02-20 09:53:58,125 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3583.7 MB)
2026-02-20 09:54:09,855 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:54:09,855 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-20 09:54:09,933 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11873.0 MB)
2026-02-20 09:54:09,936 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 3583.7 MB)
2026-02-20 09:54:21,638 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:54:21,638 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-20 09:54:21,727 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 11873.0 MB)
2026-02-20 09:54:21,730 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 3583.7 MB)
