
[1m[36mâ–¸ Loading model weights[0m

[1m[36mâ–¸ Loading GPU weights[0m

[1m[36mâ–¸ Loading CPU expert weights[0m

[1m[36mâ–¸ Initializing GPU prefill managers[0m

[1m[36mâ–¸ Loading cached heatmap[0m

[1m[36mâ–¸ Warming up CUDA runtime[0m

[1m[36mâ–¸ Allocating HCS expert cache[0m


--- STDERR ---
2026-02-20 10:08:49,696 krasis.server INFO Logging to /home/main/Documents/Claude/krasis/krasis.log
2026-02-20 10:08:49,696 krasis.server INFO HCS strategy: PP=1, 1 GPUs available
2026-02-20 10:08:49,697 krasis.model INFO KrasisModel: 94 layers, PP=[94], 1 GPUs, attn=flashinfer
2026-02-20 10:08:49,719 krasis.server INFO â”€â”€ Loading model weights â”€â”€
2026-02-20 10:08:49,719 krasis.model INFO RAM budget: experts=230.6 GB, overhead=20.0 GB, total=250.6 GB needed | system: 995.5 GB total, 955.9 GB available
2026-02-20 10:08:49,719 krasis.model INFO RAM budget OK: 250.6 GB needed, 744.9 GB headroom
2026-02-20 10:08:49,720 krasis.model INFO RAM watchdog started: will exit if < 5.0% free
2026-02-20 10:08:49,720 krasis.model INFO Phase 1: Loading GPU weights (streaming INT8)...
2026-02-20 10:08:49,869 krasis.model INFO Loading full base model to primary device cuda:0...
2026-02-20 10:08:49,870 krasis.weight_loader INFO Loading embedding: model.embed_tokens.weight
2026-02-20 10:08:50,375 krasis.weight_loader INFO Layer 0 loaded in 0.3s (GPU alloc: 1257 MB, moe=True, type=full_attention)
2026-02-20 10:08:50,716 krasis.weight_loader INFO Layer 1 loaded in 0.3s (GPU alloc: 1464 MB, moe=True, type=full_attention)
2026-02-20 10:08:51,038 krasis.weight_loader INFO Layer 2 loaded in 0.3s (GPU alloc: 1543 MB, moe=True, type=full_attention)
2026-02-20 10:08:51,362 krasis.weight_loader INFO Layer 3 loaded in 0.3s (GPU alloc: 1623 MB, moe=True, type=full_attention)
2026-02-20 10:08:51,688 krasis.weight_loader INFO Layer 4 loaded in 0.3s (GPU alloc: 1702 MB, moe=True, type=full_attention)
2026-02-20 10:08:52,021 krasis.weight_loader INFO Layer 5 loaded in 0.3s (GPU alloc: 1781 MB, moe=True, type=full_attention)
2026-02-20 10:08:52,352 krasis.weight_loader INFO Layer 6 loaded in 0.3s (GPU alloc: 1860 MB, moe=True, type=full_attention)
2026-02-20 10:08:52,684 krasis.weight_loader INFO Layer 7 loaded in 0.3s (GPU alloc: 1939 MB, moe=True, type=full_attention)
2026-02-20 10:08:53,016 krasis.weight_loader INFO Layer 8 loaded in 0.3s (GPU alloc: 2018 MB, moe=True, type=full_attention)
2026-02-20 10:08:53,349 krasis.weight_loader INFO Layer 9 loaded in 0.3s (GPU alloc: 2098 MB, moe=True, type=full_attention)
2026-02-20 10:08:53,682 krasis.weight_loader INFO Layer 10 loaded in 0.3s (GPU alloc: 2177 MB, moe=True, type=full_attention)
2026-02-20 10:08:54,011 krasis.weight_loader INFO Layer 11 loaded in 0.3s (GPU alloc: 2256 MB, moe=True, type=full_attention)
2026-02-20 10:08:54,342 krasis.weight_loader INFO Layer 12 loaded in 0.3s (GPU alloc: 2335 MB, moe=True, type=full_attention)
2026-02-20 10:08:54,673 krasis.weight_loader INFO Layer 13 loaded in 0.3s (GPU alloc: 2414 MB, moe=True, type=full_attention)
2026-02-20 10:08:55,004 krasis.weight_loader INFO Layer 14 loaded in 0.3s (GPU alloc: 2493 MB, moe=True, type=full_attention)
2026-02-20 10:08:55,336 krasis.weight_loader INFO Layer 15 loaded in 0.3s (GPU alloc: 2573 MB, moe=True, type=full_attention)
2026-02-20 10:08:55,668 krasis.weight_loader INFO Layer 16 loaded in 0.3s (GPU alloc: 2652 MB, moe=True, type=full_attention)
2026-02-20 10:08:56,001 krasis.weight_loader INFO Layer 17 loaded in 0.3s (GPU alloc: 2731 MB, moe=True, type=full_attention)
2026-02-20 10:08:56,331 krasis.weight_loader INFO Layer 18 loaded in 0.3s (GPU alloc: 2810 MB, moe=True, type=full_attention)
2026-02-20 10:08:56,664 krasis.weight_loader INFO Layer 19 loaded in 0.3s (GPU alloc: 2889 MB, moe=True, type=full_attention)
2026-02-20 10:08:56,997 krasis.weight_loader INFO Layer 20 loaded in 0.3s (GPU alloc: 2968 MB, moe=True, type=full_attention)
2026-02-20 10:08:57,329 krasis.weight_loader INFO Layer 21 loaded in 0.3s (GPU alloc: 3048 MB, moe=True, type=full_attention)
2026-02-20 10:08:57,663 krasis.weight_loader INFO Layer 22 loaded in 0.3s (GPU alloc: 3127 MB, moe=True, type=full_attention)
2026-02-20 10:08:57,995 krasis.weight_loader INFO Layer 23 loaded in 0.3s (GPU alloc: 3206 MB, moe=True, type=full_attention)
2026-02-20 10:08:58,326 krasis.weight_loader INFO Layer 24 loaded in 0.3s (GPU alloc: 3285 MB, moe=True, type=full_attention)
2026-02-20 10:08:58,660 krasis.weight_loader INFO Layer 25 loaded in 0.3s (GPU alloc: 3364 MB, moe=True, type=full_attention)
2026-02-20 10:08:58,993 krasis.weight_loader INFO Layer 26 loaded in 0.3s (GPU alloc: 3443 MB, moe=True, type=full_attention)
2026-02-20 10:08:59,326 krasis.weight_loader INFO Layer 27 loaded in 0.3s (GPU alloc: 3523 MB, moe=True, type=full_attention)
2026-02-20 10:08:59,659 krasis.weight_loader INFO Layer 28 loaded in 0.3s (GPU alloc: 3602 MB, moe=True, type=full_attention)
2026-02-20 10:08:59,992 krasis.weight_loader INFO Layer 29 loaded in 0.3s (GPU alloc: 3681 MB, moe=True, type=full_attention)
2026-02-20 10:09:00,325 krasis.weight_loader INFO Layer 30 loaded in 0.3s (GPU alloc: 3760 MB, moe=True, type=full_attention)
2026-02-20 10:09:00,658 krasis.weight_loader INFO Layer 31 loaded in 0.3s (GPU alloc: 3839 MB, moe=True, type=full_attention)
2026-02-20 10:09:00,990 krasis.weight_loader INFO Layer 32 loaded in 0.3s (GPU alloc: 3918 MB, moe=True, type=full_attention)
2026-02-20 10:09:01,322 krasis.weight_loader INFO Layer 33 loaded in 0.3s (GPU alloc: 3998 MB, moe=True, type=full_attention)
2026-02-20 10:09:01,655 krasis.weight_loader INFO Layer 34 loaded in 0.3s (GPU alloc: 4077 MB, moe=True, type=full_attention)
2026-02-20 10:09:01,988 krasis.weight_loader INFO Layer 35 loaded in 0.3s (GPU alloc: 4156 MB, moe=True, type=full_attention)
2026-02-20 10:09:02,320 krasis.weight_loader INFO Layer 36 loaded in 0.3s (GPU alloc: 4235 MB, moe=True, type=full_attention)
2026-02-20 10:09:02,653 krasis.weight_loader INFO Layer 37 loaded in 0.3s (GPU alloc: 4314 MB, moe=True, type=full_attention)
2026-02-20 10:09:02,986 krasis.weight_loader INFO Layer 38 loaded in 0.3s (GPU alloc: 4393 MB, moe=True, type=full_attention)
2026-02-20 10:09:03,318 krasis.weight_loader INFO Layer 39 loaded in 0.3s (GPU alloc: 4473 MB, moe=True, type=full_attention)
2026-02-20 10:09:03,650 krasis.weight_loader INFO Layer 40 loaded in 0.3s (GPU alloc: 4552 MB, moe=True, type=full_attention)
2026-02-20 10:09:03,982 krasis.weight_loader INFO Layer 41 loaded in 0.3s (GPU alloc: 4631 MB, moe=True, type=full_attention)
2026-02-20 10:09:04,314 krasis.weight_loader INFO Layer 42 loaded in 0.3s (GPU alloc: 4710 MB, moe=True, type=full_attention)
2026-02-20 10:09:04,642 krasis.weight_loader INFO Layer 43 loaded in 0.3s (GPU alloc: 4789 MB, moe=True, type=full_attention)
2026-02-20 10:09:04,974 krasis.weight_loader INFO Layer 44 loaded in 0.3s (GPU alloc: 4868 MB, moe=True, type=full_attention)
2026-02-20 10:09:05,304 krasis.weight_loader INFO Layer 45 loaded in 0.3s (GPU alloc: 4948 MB, moe=True, type=full_attention)
2026-02-20 10:09:05,635 krasis.weight_loader INFO Layer 46 loaded in 0.3s (GPU alloc: 5027 MB, moe=True, type=full_attention)
2026-02-20 10:09:05,972 krasis.weight_loader INFO Layer 47 loaded in 0.3s (GPU alloc: 5106 MB, moe=True, type=full_attention)
2026-02-20 10:09:06,289 krasis.weight_loader INFO Layer 48 loaded in 0.3s (GPU alloc: 5185 MB, moe=True, type=full_attention)
2026-02-20 10:09:06,622 krasis.weight_loader INFO Layer 49 loaded in 0.3s (GPU alloc: 5264 MB, moe=True, type=full_attention)
2026-02-20 10:09:06,945 krasis.weight_loader INFO Layer 50 loaded in 0.3s (GPU alloc: 5343 MB, moe=True, type=full_attention)
2026-02-20 10:09:07,271 krasis.weight_loader INFO Layer 51 loaded in 0.3s (GPU alloc: 5423 MB, moe=True, type=full_attention)
2026-02-20 10:09:07,600 krasis.weight_loader INFO Layer 52 loaded in 0.3s (GPU alloc: 5502 MB, moe=True, type=full_attention)
2026-02-20 10:09:07,927 krasis.weight_loader INFO Layer 53 loaded in 0.3s (GPU alloc: 5581 MB, moe=True, type=full_attention)
2026-02-20 10:09:08,256 krasis.weight_loader INFO Layer 54 loaded in 0.3s (GPU alloc: 5660 MB, moe=True, type=full_attention)
2026-02-20 10:09:08,584 krasis.weight_loader INFO Layer 55 loaded in 0.3s (GPU alloc: 5739 MB, moe=True, type=full_attention)
2026-02-20 10:09:08,913 krasis.weight_loader INFO Layer 56 loaded in 0.3s (GPU alloc: 5818 MB, moe=True, type=full_attention)
2026-02-20 10:09:09,242 krasis.weight_loader INFO Layer 57 loaded in 0.3s (GPU alloc: 5898 MB, moe=True, type=full_attention)
2026-02-20 10:09:09,573 krasis.weight_loader INFO Layer 58 loaded in 0.3s (GPU alloc: 5977 MB, moe=True, type=full_attention)
2026-02-20 10:09:09,903 krasis.weight_loader INFO Layer 59 loaded in 0.3s (GPU alloc: 6056 MB, moe=True, type=full_attention)
2026-02-20 10:09:10,233 krasis.weight_loader INFO Layer 60 loaded in 0.3s (GPU alloc: 6135 MB, moe=True, type=full_attention)
2026-02-20 10:09:10,555 krasis.weight_loader INFO Layer 61 loaded in 0.3s (GPU alloc: 6214 MB, moe=True, type=full_attention)
2026-02-20 10:09:10,881 krasis.weight_loader INFO Layer 62 loaded in 0.3s (GPU alloc: 6293 MB, moe=True, type=full_attention)
2026-02-20 10:09:11,213 krasis.weight_loader INFO Layer 63 loaded in 0.3s (GPU alloc: 6373 MB, moe=True, type=full_attention)
2026-02-20 10:09:11,544 krasis.weight_loader INFO Layer 64 loaded in 0.3s (GPU alloc: 6452 MB, moe=True, type=full_attention)
2026-02-20 10:09:11,876 krasis.weight_loader INFO Layer 65 loaded in 0.3s (GPU alloc: 6531 MB, moe=True, type=full_attention)
2026-02-20 10:09:12,209 krasis.weight_loader INFO Layer 66 loaded in 0.3s (GPU alloc: 6610 MB, moe=True, type=full_attention)
2026-02-20 10:09:12,542 krasis.weight_loader INFO Layer 67 loaded in 0.3s (GPU alloc: 6689 MB, moe=True, type=full_attention)
2026-02-20 10:09:12,876 krasis.weight_loader INFO Layer 68 loaded in 0.3s (GPU alloc: 6768 MB, moe=True, type=full_attention)
2026-02-20 10:09:13,210 krasis.weight_loader INFO Layer 69 loaded in 0.3s (GPU alloc: 6848 MB, moe=True, type=full_attention)
2026-02-20 10:09:13,543 krasis.weight_loader INFO Layer 70 loaded in 0.3s (GPU alloc: 6927 MB, moe=True, type=full_attention)
2026-02-20 10:09:13,877 krasis.weight_loader INFO Layer 71 loaded in 0.3s (GPU alloc: 7006 MB, moe=True, type=full_attention)
2026-02-20 10:09:14,212 krasis.weight_loader INFO Layer 72 loaded in 0.3s (GPU alloc: 7085 MB, moe=True, type=full_attention)
2026-02-20 10:09:14,547 krasis.weight_loader INFO Layer 73 loaded in 0.3s (GPU alloc: 7164 MB, moe=True, type=full_attention)
2026-02-20 10:09:14,880 krasis.weight_loader INFO Layer 74 loaded in 0.3s (GPU alloc: 7243 MB, moe=True, type=full_attention)
2026-02-20 10:09:15,212 krasis.weight_loader INFO Layer 75 loaded in 0.3s (GPU alloc: 7323 MB, moe=True, type=full_attention)
2026-02-20 10:09:15,544 krasis.weight_loader INFO Layer 76 loaded in 0.3s (GPU alloc: 7402 MB, moe=True, type=full_attention)
2026-02-20 10:09:15,878 krasis.weight_loader INFO Layer 77 loaded in 0.3s (GPU alloc: 7481 MB, moe=True, type=full_attention)
2026-02-20 10:09:16,213 krasis.weight_loader INFO Layer 78 loaded in 0.3s (GPU alloc: 7560 MB, moe=True, type=full_attention)
2026-02-20 10:09:16,545 krasis.weight_loader INFO Layer 79 loaded in 0.3s (GPU alloc: 7639 MB, moe=True, type=full_attention)
2026-02-20 10:09:16,878 krasis.weight_loader INFO Layer 80 loaded in 0.3s (GPU alloc: 7718 MB, moe=True, type=full_attention)
2026-02-20 10:09:17,210 krasis.weight_loader INFO Layer 81 loaded in 0.3s (GPU alloc: 7798 MB, moe=True, type=full_attention)
2026-02-20 10:09:17,543 krasis.weight_loader INFO Layer 82 loaded in 0.3s (GPU alloc: 7877 MB, moe=True, type=full_attention)
2026-02-20 10:09:17,877 krasis.weight_loader INFO Layer 83 loaded in 0.3s (GPU alloc: 7956 MB, moe=True, type=full_attention)
2026-02-20 10:09:18,211 krasis.weight_loader INFO Layer 84 loaded in 0.3s (GPU alloc: 8035 MB, moe=True, type=full_attention)
2026-02-20 10:09:18,545 krasis.weight_loader INFO Layer 85 loaded in 0.3s (GPU alloc: 8114 MB, moe=True, type=full_attention)
2026-02-20 10:09:18,877 krasis.weight_loader INFO Layer 86 loaded in 0.3s (GPU alloc: 8193 MB, moe=True, type=full_attention)
2026-02-20 10:09:19,210 krasis.weight_loader INFO Layer 87 loaded in 0.3s (GPU alloc: 8273 MB, moe=True, type=full_attention)
2026-02-20 10:09:19,542 krasis.weight_loader INFO Layer 88 loaded in 0.3s (GPU alloc: 8352 MB, moe=True, type=full_attention)
2026-02-20 10:09:19,876 krasis.weight_loader INFO Layer 89 loaded in 0.3s (GPU alloc: 8431 MB, moe=True, type=full_attention)
2026-02-20 10:09:20,209 krasis.weight_loader INFO Layer 90 loaded in 0.3s (GPU alloc: 8510 MB, moe=True, type=full_attention)
2026-02-20 10:09:20,543 krasis.weight_loader INFO Layer 91 loaded in 0.3s (GPU alloc: 8589 MB, moe=True, type=full_attention)
2026-02-20 10:09:20,877 krasis.weight_loader INFO Layer 92 loaded in 0.3s (GPU alloc: 8668 MB, moe=True, type=full_attention)
2026-02-20 10:09:21,211 krasis.weight_loader INFO Layer 93 loaded in 0.3s (GPU alloc: 8748 MB, moe=True, type=full_attention)
2026-02-20 10:09:21,219 krasis.weight_loader INFO Loading final norm: model.norm.weight
2026-02-20 10:09:21,219 krasis.weight_loader INFO Loading LM head: lm_head.weight (precision=int8)
2026-02-20 10:09:24,428 krasis.model INFO GPU0: 9352 MB allocated
2026-02-20 10:09:24,428 krasis.model INFO GPU weights loaded in 34.7s
2026-02-20 10:09:24,428 krasis.model INFO Phase 2: Loading CPU expert weights (Krasis INT4)...
2026-02-20 10:18:10,726 krasis.model INFO Krasis engine: 94 MoE layers, 128 experts, hidden=4096
2026-02-20 10:18:10,819 krasis.model INFO Routing weights sent to Rust engine (94 MoE layers)
2026-02-20 10:18:10,820 krasis.model INFO CPU experts loaded in 526.4s
2026-02-20 10:18:10,820 krasis.model WARNING RAM estimate deviation: estimated 230.6 GB, actual VmRSS 431.6 GB (87% off) â€” estimates may need recalibration
2026-02-20 10:18:10,820 krasis.gpu_prefill INFO GpuPrefillManager(rank 0/1): expert_slice=[0, 128), local_count=128
2026-02-20 10:18:10,820 krasis.gpu_prefill INFO GPU prefill group_size=128
2026-02-20 10:18:10,821 krasis.gpu_prefill INFO Auto chunk_size: 128 experts (19.2 MB each, 2619.9 MB budget of 6811.8 MB free)
2026-02-20 10:18:10,821 krasis.gpu_prefill INFO Hot-cached-static mode: hot experts on GPU (static), cold on CPU (parallel)
2026-02-20 10:18:10,821 krasis.gpu_prefill INFO GpuPrefillManager(engine): experts=128, hidden=4096, intermediate=1536, chunk_size=128, num_chunks=1, shared=0, scale=1.000, num_bits=8, prefill_mode=hot_cached_static, expert_divisor=-3
2026-02-20 10:18:10,821 krasis.model INFO GPU prefill manager created for cuda:0 (rank 0/1)
2026-02-20 10:18:10,821 krasis.gpu_prefill INFO Engine path: Marlin-native DMA copy (zero conversion, zero RAM cache)
2026-02-20 10:18:10,821 krasis.model INFO GPU prefill: 1 managers, threshold=1 tokens
2026-02-20 10:18:10,821 krasis.kv_cache INFO KV cache: 2000 MB â†’ 1361 pages (21.8K tokens)
2026-02-20 10:18:10,825 krasis.kv_cache INFO KV cache allocated: 94 layers Ã— 1361 pages Ã— 16 tokens = 1999 MB (gqa, gqa-split)
2026-02-20 10:18:11,216 krasis.tokenizer INFO Tokenizer loaded: vocab=151643, eos=151645, bos=-1
2026-02-20 10:18:11,216 krasis.model INFO Model fully loaded in 561.5s
2026-02-20 10:18:11,218 krasis.server INFO â”€â”€ Loading cached heatmap â”€â”€
2026-02-20 10:18:11,218 krasis.server INFO Using cached heatmap: /home/main/.krasis/models/Qwen3-235B-A22B/.krasis_cache/auto_heatmap.json
2026-02-20 10:18:11,218 krasis.server INFO â”€â”€ Warming up CUDA runtime â”€â”€
2026-02-20 10:18:11,221 krasis.model INFO Warming up CUDA runtime on all devices: ['cuda:0']
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.cudart module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.runtime module instead.
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.nvrtc module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.nvrtc module instead.
2026-02-20 10:18:15,627 krasis.linear_attention INFO Compiled linear attention chunk step (default/Inductor mode)
2026-02-20 10:18:16,615 krasis.linear_attention INFO Linear attention torch.compile warmup complete on cuda:0
2026-02-20 10:18:16,907 krasis.model INFO CUDA runtime warmup on cuda:0 complete: 99 MB consumed (4715 MB free before â†’ 4616 MB free after)
2026-02-20 10:18:16,907 krasis.server INFO â”€â”€ Allocating HCS expert cache â”€â”€
2026-02-20 10:18:16,907 krasis.server INFO Unified HCS: initializing with devices: ['cuda:0']
2026-02-20 10:18:16,965 krasis.server INFO Test prompt: 10000 tokens
2026-02-20 10:18:17,260 krasis.gpu_prefill INFO HCS state cleared.
2026-02-20 10:18:17,266 krasis.gpu_prefill INFO Loaded heatmap from /home/main/.krasis/models/Qwen3-235B-A22B/.krasis_cache/auto_heatmap.json: 7935 entries
2026-02-20 10:18:17,268 krasis.gpu_prefill INFO HCS unified VRAM budget: 1 devices, 19.2 MB/expert, per-device max experts: {'cuda:0': 290}, total max: 290
2026-02-20 10:18:17,270 krasis.gpu_prefill INFO HCS uniform allocation: 3 experts/layer across 94 layers = 282 total
2026-02-20 10:18:17,271 krasis.gpu_prefill INFO HCS assignment check: device 0 (cuda:0) â†’ 282 experts (budget: 290)
2026-02-20 10:18:17,271 krasis.gpu_prefill INFO HCS pre-load: cuda:0 allocated=11360 MB, free=4466 MB
2026-02-20 10:18:17,355 krasis.gpu_prefill INFO HCS load L0: total=58 MB | dev0: alloc=11415MB free=4390MB loaded=58MB(3exp)
2026-02-20 10:18:17,769 krasis.gpu_prefill INFO HCS load L6: total=403 MB | dev0: alloc=11744MB free=4062MB loaded=403MB(21exp)
2026-02-20 10:18:18,188 krasis.gpu_prefill INFO HCS load L12: total=748 MB | dev0: alloc=12073MB free=3732MB loaded=748MB(39exp)
2026-02-20 10:18:18,607 krasis.gpu_prefill INFO HCS load L18: total=1093 MB | dev0: alloc=12402MB free=3402MB loaded=1093MB(57exp)
2026-02-20 10:18:19,004 krasis.gpu_prefill INFO HCS load L24: total=1438 MB | dev0: alloc=12731MB free=3074MB loaded=1438MB(75exp)
2026-02-20 10:18:19,396 krasis.gpu_prefill INFO HCS load L30: total=1783 MB | dev0: alloc=13061MB free=2744MB loaded=1783MB(93exp)
2026-02-20 10:18:19,789 krasis.gpu_prefill INFO HCS load L36: total=2128 MB | dev0: alloc=13390MB free=2416MB loaded=2128MB(111exp)
2026-02-20 10:18:20,181 krasis.gpu_prefill INFO HCS load L42: total=2473 MB | dev0: alloc=13719MB free=2086MB loaded=2473MB(129exp)
2026-02-20 10:18:20,576 krasis.gpu_prefill INFO HCS load L48: total=2818 MB | dev0: alloc=14048MB free=1758MB loaded=2818MB(147exp)
2026-02-20 10:18:20,968 krasis.gpu_prefill INFO HCS load L54: total=3163 MB | dev0: alloc=14377MB free=1428MB loaded=3163MB(165exp)
2026-02-20 10:18:21,361 krasis.gpu_prefill INFO HCS load L60: total=3508 MB | dev0: alloc=14706MB free=1098MB loaded=3508MB(183exp)
2026-02-20 10:18:21,751 krasis.gpu_prefill INFO HCS load L66: total=3853 MB | dev0: alloc=15035MB free=770MB loaded=3853MB(201exp)
2026-02-20 10:18:22,143 krasis.gpu_prefill INFO HCS load L72: total=4198 MB | dev0: alloc=15364MB free=440MB loaded=4198MB(219exp)
2026-02-20 10:18:22,535 krasis.gpu_prefill INFO HCS load L78: total=4543 MB | dev0: alloc=15693MB free=112MB loaded=4543MB(237exp)
2026-02-20 10:18:22,754 krasis.server CRITICAL Uncaught exception
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/main/Documents/Claude/krasis/python/krasis/server.py", line 680, in <module>
    main()
  File "/home/main/Documents/Claude/krasis/python/krasis/server.py", line 523, in main
    manager._init_hot_cached_static(
  File "/home/main/Documents/Claude/krasis/python/krasis/gpu_prefill.py", line 2877, in _init_hot_cached_static
    w13 = w13_cpu.to(hcs_dev.device, non_blocking=True)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 36.00 MiB. GPU 0 has a total capacity of 15.58 GiB of which 2.25 MiB is free. Including non-PyTorch memory, this process has 15.57 GiB memory in use. Of the allocated memory 15.43 GiB is allocated by PyTorch, and 18.68 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/main/Documents/Claude/krasis/python/krasis/server.py", line 680, in <module>
    main()
  File "/home/main/Documents/Claude/krasis/python/krasis/server.py", line 523, in main
    manager._init_hot_cached_static(
  File "/home/main/Documents/Claude/krasis/python/krasis/gpu_prefill.py", line 2877, in _init_hot_cached_static
    w13 = w13_cpu.to(hcs_dev.device, non_blocking=True)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 36.00 MiB. GPU 0 has a total capacity of 15.58 GiB of which 2.25 MiB is free. Including non-PyTorch memory, this process has 15.57 GiB memory in use. Of the allocated memory 15.43 GiB is allocated by PyTorch, and 18.68 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
