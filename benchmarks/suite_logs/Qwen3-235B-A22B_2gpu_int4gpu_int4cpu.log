
[1m[36mâ–¸ Loading model weights[0m

[1m[36mâ–¸ Loading GPU weights[0m

[1m[36mâ–¸ Loading CPU expert weights[0m

[1m[36mâ–¸ Initializing GPU prefill managers[0m

[1m[36mâ–¸ Loading cached heatmap[0m

[1m[36mâ–¸ Warming up CUDA runtime[0m

[1m[36mâ–¸ Allocating HCS expert cache[0m


--- STDERR ---
2026-02-20 10:19:17,362 krasis.server INFO Logging to /home/main/Documents/Claude/krasis/krasis.log
2026-02-20 10:19:17,363 krasis.server INFO HCS strategy: PP=1, 2 GPUs available
2026-02-20 10:19:17,363 krasis.model INFO KrasisModel: 94 layers, PP=[94], 1 GPUs, attn=flashinfer
2026-02-20 10:19:17,388 krasis.server INFO â”€â”€ Loading model weights â”€â”€
2026-02-20 10:19:17,388 krasis.model INFO RAM budget: experts=117.1 GB, overhead=20.0 GB, total=137.1 GB needed | system: 995.5 GB total, 956.7 GB available
2026-02-20 10:19:17,388 krasis.model INFO RAM budget OK: 137.1 GB needed, 858.4 GB headroom
2026-02-20 10:19:17,389 krasis.model INFO RAM watchdog started: will exit if < 5.0% free
2026-02-20 10:19:17,389 krasis.model INFO Phase 1: Loading GPU weights (streaming INT8)...
2026-02-20 10:19:17,540 krasis.model INFO Loading full base model to primary device cuda:0...
2026-02-20 10:19:17,540 krasis.weight_loader INFO Loading embedding: model.embed_tokens.weight
2026-02-20 10:19:18,897 krasis.weight_loader INFO Layer 0 loaded in 0.4s (GPU alloc: 1257 MB, moe=True, type=full_attention)
2026-02-20 10:19:19,327 krasis.weight_loader INFO Layer 1 loaded in 0.4s (GPU alloc: 1464 MB, moe=True, type=full_attention)
2026-02-20 10:19:19,743 krasis.weight_loader INFO Layer 2 loaded in 0.4s (GPU alloc: 1543 MB, moe=True, type=full_attention)
2026-02-20 10:19:20,179 krasis.weight_loader INFO Layer 3 loaded in 0.4s (GPU alloc: 1623 MB, moe=True, type=full_attention)
2026-02-20 10:19:20,611 krasis.weight_loader INFO Layer 4 loaded in 0.4s (GPU alloc: 1702 MB, moe=True, type=full_attention)
2026-02-20 10:19:21,035 krasis.weight_loader INFO Layer 5 loaded in 0.4s (GPU alloc: 1781 MB, moe=True, type=full_attention)
2026-02-20 10:19:21,458 krasis.weight_loader INFO Layer 6 loaded in 0.4s (GPU alloc: 1860 MB, moe=True, type=full_attention)
2026-02-20 10:19:21,882 krasis.weight_loader INFO Layer 7 loaded in 0.4s (GPU alloc: 1939 MB, moe=True, type=full_attention)
2026-02-20 10:19:22,304 krasis.weight_loader INFO Layer 8 loaded in 0.4s (GPU alloc: 2018 MB, moe=True, type=full_attention)
2026-02-20 10:19:22,724 krasis.weight_loader INFO Layer 9 loaded in 0.4s (GPU alloc: 2098 MB, moe=True, type=full_attention)
2026-02-20 10:19:23,131 krasis.weight_loader INFO Layer 10 loaded in 0.4s (GPU alloc: 2177 MB, moe=True, type=full_attention)
2026-02-20 10:19:23,539 krasis.weight_loader INFO Layer 11 loaded in 0.4s (GPU alloc: 2256 MB, moe=True, type=full_attention)
2026-02-20 10:19:23,959 krasis.weight_loader INFO Layer 12 loaded in 0.4s (GPU alloc: 2335 MB, moe=True, type=full_attention)
2026-02-20 10:19:24,381 krasis.weight_loader INFO Layer 13 loaded in 0.4s (GPU alloc: 2414 MB, moe=True, type=full_attention)
2026-02-20 10:19:24,805 krasis.weight_loader INFO Layer 14 loaded in 0.4s (GPU alloc: 2493 MB, moe=True, type=full_attention)
2026-02-20 10:19:25,225 krasis.weight_loader INFO Layer 15 loaded in 0.4s (GPU alloc: 2573 MB, moe=True, type=full_attention)
2026-02-20 10:19:25,625 krasis.weight_loader INFO Layer 16 loaded in 0.4s (GPU alloc: 2652 MB, moe=True, type=full_attention)
2026-02-20 10:19:26,021 krasis.weight_loader INFO Layer 17 loaded in 0.4s (GPU alloc: 2731 MB, moe=True, type=full_attention)
2026-02-20 10:19:26,420 krasis.weight_loader INFO Layer 18 loaded in 0.4s (GPU alloc: 2810 MB, moe=True, type=full_attention)
2026-02-20 10:19:26,820 krasis.weight_loader INFO Layer 19 loaded in 0.4s (GPU alloc: 2889 MB, moe=True, type=full_attention)
2026-02-20 10:19:27,220 krasis.weight_loader INFO Layer 20 loaded in 0.4s (GPU alloc: 2968 MB, moe=True, type=full_attention)
2026-02-20 10:19:27,611 krasis.weight_loader INFO Layer 21 loaded in 0.4s (GPU alloc: 3048 MB, moe=True, type=full_attention)
2026-02-20 10:19:28,002 krasis.weight_loader INFO Layer 22 loaded in 0.4s (GPU alloc: 3127 MB, moe=True, type=full_attention)
2026-02-20 10:19:28,376 krasis.weight_loader INFO Layer 23 loaded in 0.4s (GPU alloc: 3206 MB, moe=True, type=full_attention)
2026-02-20 10:19:28,768 krasis.weight_loader INFO Layer 24 loaded in 0.4s (GPU alloc: 3285 MB, moe=True, type=full_attention)
2026-02-20 10:19:29,166 krasis.weight_loader INFO Layer 25 loaded in 0.4s (GPU alloc: 3364 MB, moe=True, type=full_attention)
2026-02-20 10:19:29,575 krasis.weight_loader INFO Layer 26 loaded in 0.4s (GPU alloc: 3443 MB, moe=True, type=full_attention)
2026-02-20 10:19:29,978 krasis.weight_loader INFO Layer 27 loaded in 0.4s (GPU alloc: 3523 MB, moe=True, type=full_attention)
2026-02-20 10:19:30,344 krasis.weight_loader INFO Layer 28 loaded in 0.4s (GPU alloc: 3602 MB, moe=True, type=full_attention)
2026-02-20 10:19:30,744 krasis.weight_loader INFO Layer 29 loaded in 0.4s (GPU alloc: 3681 MB, moe=True, type=full_attention)
2026-02-20 10:19:31,129 krasis.weight_loader INFO Layer 30 loaded in 0.4s (GPU alloc: 3760 MB, moe=True, type=full_attention)
2026-02-20 10:19:31,524 krasis.weight_loader INFO Layer 31 loaded in 0.4s (GPU alloc: 3839 MB, moe=True, type=full_attention)
2026-02-20 10:19:31,912 krasis.weight_loader INFO Layer 32 loaded in 0.4s (GPU alloc: 3918 MB, moe=True, type=full_attention)
2026-02-20 10:19:32,294 krasis.weight_loader INFO Layer 33 loaded in 0.4s (GPU alloc: 3998 MB, moe=True, type=full_attention)
2026-02-20 10:19:32,683 krasis.weight_loader INFO Layer 34 loaded in 0.4s (GPU alloc: 4077 MB, moe=True, type=full_attention)
2026-02-20 10:19:33,077 krasis.weight_loader INFO Layer 35 loaded in 0.4s (GPU alloc: 4156 MB, moe=True, type=full_attention)
2026-02-20 10:19:33,457 krasis.weight_loader INFO Layer 36 loaded in 0.4s (GPU alloc: 4235 MB, moe=True, type=full_attention)
2026-02-20 10:19:33,858 krasis.weight_loader INFO Layer 37 loaded in 0.4s (GPU alloc: 4314 MB, moe=True, type=full_attention)
2026-02-20 10:19:34,243 krasis.weight_loader INFO Layer 38 loaded in 0.4s (GPU alloc: 4393 MB, moe=True, type=full_attention)
2026-02-20 10:19:34,626 krasis.weight_loader INFO Layer 39 loaded in 0.4s (GPU alloc: 4473 MB, moe=True, type=full_attention)
2026-02-20 10:19:35,013 krasis.weight_loader INFO Layer 40 loaded in 0.4s (GPU alloc: 4552 MB, moe=True, type=full_attention)
2026-02-20 10:19:35,403 krasis.weight_loader INFO Layer 41 loaded in 0.4s (GPU alloc: 4631 MB, moe=True, type=full_attention)
2026-02-20 10:19:35,791 krasis.weight_loader INFO Layer 42 loaded in 0.4s (GPU alloc: 4710 MB, moe=True, type=full_attention)
2026-02-20 10:19:36,169 krasis.weight_loader INFO Layer 43 loaded in 0.4s (GPU alloc: 4789 MB, moe=True, type=full_attention)
2026-02-20 10:19:36,554 krasis.weight_loader INFO Layer 44 loaded in 0.4s (GPU alloc: 4868 MB, moe=True, type=full_attention)
2026-02-20 10:19:36,945 krasis.weight_loader INFO Layer 45 loaded in 0.4s (GPU alloc: 4948 MB, moe=True, type=full_attention)
2026-02-20 10:19:37,332 krasis.weight_loader INFO Layer 46 loaded in 0.4s (GPU alloc: 5027 MB, moe=True, type=full_attention)
2026-02-20 10:19:37,717 krasis.weight_loader INFO Layer 47 loaded in 0.4s (GPU alloc: 5106 MB, moe=True, type=full_attention)
2026-02-20 10:19:38,102 krasis.weight_loader INFO Layer 48 loaded in 0.4s (GPU alloc: 5185 MB, moe=True, type=full_attention)
2026-02-20 10:19:38,489 krasis.weight_loader INFO Layer 49 loaded in 0.4s (GPU alloc: 5264 MB, moe=True, type=full_attention)
2026-02-20 10:19:38,884 krasis.weight_loader INFO Layer 50 loaded in 0.4s (GPU alloc: 5343 MB, moe=True, type=full_attention)
2026-02-20 10:19:39,273 krasis.weight_loader INFO Layer 51 loaded in 0.4s (GPU alloc: 5423 MB, moe=True, type=full_attention)
2026-02-20 10:19:39,669 krasis.weight_loader INFO Layer 52 loaded in 0.4s (GPU alloc: 5502 MB, moe=True, type=full_attention)
2026-02-20 10:19:40,051 krasis.weight_loader INFO Layer 53 loaded in 0.4s (GPU alloc: 5581 MB, moe=True, type=full_attention)
2026-02-20 10:19:40,443 krasis.weight_loader INFO Layer 54 loaded in 0.4s (GPU alloc: 5660 MB, moe=True, type=full_attention)
2026-02-20 10:19:40,857 krasis.weight_loader INFO Layer 55 loaded in 0.4s (GPU alloc: 5739 MB, moe=True, type=full_attention)
2026-02-20 10:19:41,243 krasis.weight_loader INFO Layer 56 loaded in 0.4s (GPU alloc: 5818 MB, moe=True, type=full_attention)
2026-02-20 10:19:41,637 krasis.weight_loader INFO Layer 57 loaded in 0.4s (GPU alloc: 5898 MB, moe=True, type=full_attention)
2026-02-20 10:19:42,035 krasis.weight_loader INFO Layer 58 loaded in 0.4s (GPU alloc: 5977 MB, moe=True, type=full_attention)
2026-02-20 10:19:42,427 krasis.weight_loader INFO Layer 59 loaded in 0.4s (GPU alloc: 6056 MB, moe=True, type=full_attention)
2026-02-20 10:19:42,808 krasis.weight_loader INFO Layer 60 loaded in 0.4s (GPU alloc: 6135 MB, moe=True, type=full_attention)
2026-02-20 10:19:43,191 krasis.weight_loader INFO Layer 61 loaded in 0.4s (GPU alloc: 6214 MB, moe=True, type=full_attention)
2026-02-20 10:19:43,571 krasis.weight_loader INFO Layer 62 loaded in 0.4s (GPU alloc: 6293 MB, moe=True, type=full_attention)
2026-02-20 10:19:43,957 krasis.weight_loader INFO Layer 63 loaded in 0.4s (GPU alloc: 6373 MB, moe=True, type=full_attention)
2026-02-20 10:19:44,325 krasis.weight_loader INFO Layer 64 loaded in 0.4s (GPU alloc: 6452 MB, moe=True, type=full_attention)
2026-02-20 10:19:44,702 krasis.weight_loader INFO Layer 65 loaded in 0.4s (GPU alloc: 6531 MB, moe=True, type=full_attention)
2026-02-20 10:19:45,080 krasis.weight_loader INFO Layer 66 loaded in 0.4s (GPU alloc: 6610 MB, moe=True, type=full_attention)
2026-02-20 10:19:45,454 krasis.weight_loader INFO Layer 67 loaded in 0.4s (GPU alloc: 6689 MB, moe=True, type=full_attention)
2026-02-20 10:19:45,837 krasis.weight_loader INFO Layer 68 loaded in 0.4s (GPU alloc: 6768 MB, moe=True, type=full_attention)
2026-02-20 10:19:46,219 krasis.weight_loader INFO Layer 69 loaded in 0.4s (GPU alloc: 6848 MB, moe=True, type=full_attention)
2026-02-20 10:19:46,598 krasis.weight_loader INFO Layer 70 loaded in 0.4s (GPU alloc: 6927 MB, moe=True, type=full_attention)
2026-02-20 10:19:46,972 krasis.weight_loader INFO Layer 71 loaded in 0.4s (GPU alloc: 7006 MB, moe=True, type=full_attention)
2026-02-20 10:19:47,344 krasis.weight_loader INFO Layer 72 loaded in 0.4s (GPU alloc: 7085 MB, moe=True, type=full_attention)
2026-02-20 10:19:47,721 krasis.weight_loader INFO Layer 73 loaded in 0.4s (GPU alloc: 7164 MB, moe=True, type=full_attention)
2026-02-20 10:19:48,094 krasis.weight_loader INFO Layer 74 loaded in 0.4s (GPU alloc: 7243 MB, moe=True, type=full_attention)
2026-02-20 10:19:48,467 krasis.weight_loader INFO Layer 75 loaded in 0.4s (GPU alloc: 7323 MB, moe=True, type=full_attention)
2026-02-20 10:19:48,846 krasis.weight_loader INFO Layer 76 loaded in 0.4s (GPU alloc: 7402 MB, moe=True, type=full_attention)
2026-02-20 10:19:49,230 krasis.weight_loader INFO Layer 77 loaded in 0.4s (GPU alloc: 7481 MB, moe=True, type=full_attention)
2026-02-20 10:19:49,596 krasis.weight_loader INFO Layer 78 loaded in 0.4s (GPU alloc: 7560 MB, moe=True, type=full_attention)
2026-02-20 10:19:49,989 krasis.weight_loader INFO Layer 79 loaded in 0.4s (GPU alloc: 7639 MB, moe=True, type=full_attention)
2026-02-20 10:19:50,379 krasis.weight_loader INFO Layer 80 loaded in 0.4s (GPU alloc: 7718 MB, moe=True, type=full_attention)
2026-02-20 10:19:50,753 krasis.weight_loader INFO Layer 81 loaded in 0.4s (GPU alloc: 7798 MB, moe=True, type=full_attention)
2026-02-20 10:19:51,134 krasis.weight_loader INFO Layer 82 loaded in 0.4s (GPU alloc: 7877 MB, moe=True, type=full_attention)
2026-02-20 10:19:51,500 krasis.weight_loader INFO Layer 83 loaded in 0.4s (GPU alloc: 7956 MB, moe=True, type=full_attention)
2026-02-20 10:19:51,882 krasis.weight_loader INFO Layer 84 loaded in 0.4s (GPU alloc: 8035 MB, moe=True, type=full_attention)
2026-02-20 10:19:52,249 krasis.weight_loader INFO Layer 85 loaded in 0.4s (GPU alloc: 8114 MB, moe=True, type=full_attention)
2026-02-20 10:19:52,625 krasis.weight_loader INFO Layer 86 loaded in 0.4s (GPU alloc: 8193 MB, moe=True, type=full_attention)
2026-02-20 10:19:53,007 krasis.weight_loader INFO Layer 87 loaded in 0.4s (GPU alloc: 8273 MB, moe=True, type=full_attention)
2026-02-20 10:19:53,358 krasis.weight_loader INFO Layer 88 loaded in 0.3s (GPU alloc: 8352 MB, moe=True, type=full_attention)
2026-02-20 10:19:53,747 krasis.weight_loader INFO Layer 89 loaded in 0.4s (GPU alloc: 8431 MB, moe=True, type=full_attention)
2026-02-20 10:19:54,117 krasis.weight_loader INFO Layer 90 loaded in 0.4s (GPU alloc: 8510 MB, moe=True, type=full_attention)
2026-02-20 10:19:54,479 krasis.weight_loader INFO Layer 91 loaded in 0.4s (GPU alloc: 8589 MB, moe=True, type=full_attention)
2026-02-20 10:19:54,845 krasis.weight_loader INFO Layer 92 loaded in 0.4s (GPU alloc: 8668 MB, moe=True, type=full_attention)
2026-02-20 10:19:55,214 krasis.weight_loader INFO Layer 93 loaded in 0.4s (GPU alloc: 8748 MB, moe=True, type=full_attention)
2026-02-20 10:19:55,222 krasis.weight_loader INFO Loading final norm: model.norm.weight
2026-02-20 10:19:55,222 krasis.weight_loader INFO Loading LM head: lm_head.weight (precision=int8)
2026-02-20 10:19:57,641 krasis.model INFO Copying full base model weights to cuda:1...
2026-02-20 10:20:59,014 krasis.model INFO Full base model copied to cuda:1 in 61.4s (9352 MB allocated)
2026-02-20 10:21:00,041 krasis.model INFO GPU0: 9352 MB allocated
2026-02-20 10:21:00,041 krasis.model INFO GPU weights loaded in 102.7s
2026-02-20 10:21:00,041 krasis.model INFO Phase 2: Loading CPU expert weights (Krasis INT4)...
2026-02-20 10:26:24,851 krasis.model INFO Krasis engine: 94 MoE layers, 128 experts, hidden=4096
2026-02-20 10:26:24,944 krasis.model INFO Routing weights sent to Rust engine (94 MoE layers)
2026-02-20 10:26:24,944 krasis.model INFO CPU experts loaded in 324.9s
2026-02-20 10:26:24,944 krasis.model WARNING RAM estimate deviation: estimated 117.1 GB, actual VmRSS 221.0 GB (89% off) â€” estimates may need recalibration
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO GpuPrefillManager(rank 0/2): expert_slice=[0, 64), local_count=64
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO GPU prefill group_size=128
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO Auto chunk_size: 128 experts (9.7 MB each, 2619.0 MB budget of 6809.7 MB free)
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO Hot-cached-static mode: hot experts on GPU (static), cold on CPU (parallel)
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO GpuPrefillManager(engine): experts=128, hidden=4096, intermediate=1536, chunk_size=128, num_chunks=1, shared=0, scale=1.000, num_bits=4, prefill_mode=hot_cached_static, expert_divisor=-3
2026-02-20 10:26:24,945 krasis.model INFO GPU prefill manager created for cuda:0 (rank 0/2)
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO GpuPrefillManager(rank 1/2): expert_slice=[64, 128), local_count=64
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO GPU prefill group_size=128
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO Auto chunk_size: 128 experts (9.7 MB each, 2619.0 MB budget of 6809.7 MB free)
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO Hot-cached-static mode: hot experts on GPU (static), cold on CPU (parallel)
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO GpuPrefillManager(engine): experts=128, hidden=4096, intermediate=1536, chunk_size=128, num_chunks=1, shared=0, scale=1.000, num_bits=4, prefill_mode=hot_cached_static, expert_divisor=-3
2026-02-20 10:26:24,945 krasis.model INFO GPU prefill manager created for cuda:1 (rank 1/2)
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO Engine path: Marlin-native DMA copy (zero conversion, zero RAM cache)
2026-02-20 10:26:24,945 krasis.gpu_prefill INFO Engine path: Marlin-native DMA copy (zero conversion, zero RAM cache)
2026-02-20 10:26:24,946 krasis.model INFO GPU prefill: 2 managers, threshold=1 tokens
2026-02-20 10:26:24,946 krasis.kv_cache INFO KV cache: 2000 MB â†’ 1361 pages (21.8K tokens)
2026-02-20 10:26:24,950 krasis.kv_cache INFO KV cache allocated: 94 layers Ã— 1361 pages Ã— 16 tokens = 1999 MB (gqa, gqa-split)
2026-02-20 10:26:25,130 krasis.model INFO CPU Hub initialized for 2 GPUs
2026-02-20 10:26:25,504 krasis.tokenizer INFO Tokenizer loaded: vocab=151643, eos=151645, bos=-1
2026-02-20 10:26:25,504 krasis.model INFO Model fully loaded in 428.1s
2026-02-20 10:26:25,506 krasis.server INFO â”€â”€ Loading cached heatmap â”€â”€
2026-02-20 10:26:25,506 krasis.server INFO Using cached heatmap: /home/main/.krasis/models/Qwen3-235B-A22B/.krasis_cache/auto_heatmap.json
2026-02-20 10:26:25,506 krasis.server INFO â”€â”€ Warming up CUDA runtime â”€â”€
2026-02-20 10:26:25,507 krasis.model INFO Warming up CUDA runtime on all devices: ['cuda:0', 'cuda:1']
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.cudart module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.runtime module instead.
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.nvrtc module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.nvrtc module instead.
2026-02-20 10:26:30,144 krasis.model WARNING CUDA warmup (Triton/Marlin) on cuda:1 failed: w_packed shape torch.Size([3072, 512]) != (3072, 192)
2026-02-20 10:26:30,147 krasis.linear_attention INFO Compiled linear attention chunk step (default/Inductor mode)
2026-02-20 10:26:30,507 krasis.linear_attention INFO Linear attention torch.compile warmup complete on cuda:0
2026-02-20 10:26:30,783 krasis.model INFO CUDA runtime warmup on cuda:0 complete: 99 MB consumed (4713 MB free before â†’ 4614 MB free after)
2026-02-20 10:26:30,783 krasis.model INFO CUDA runtime warmup on cuda:1 complete: 13 MB consumed (6810 MB free before â†’ 6797 MB free after)
2026-02-20 10:26:30,783 krasis.server INFO â”€â”€ Allocating HCS expert cache â”€â”€
2026-02-20 10:26:30,783 krasis.server INFO Unified HCS: initializing with devices: ['cuda:0', 'cuda:1']
2026-02-20 10:26:30,836 krasis.server INFO Test prompt: 10000 tokens
2026-02-20 10:26:31,115 krasis.gpu_prefill INFO HCS state cleared.
2026-02-20 10:26:31,121 krasis.gpu_prefill INFO Loaded heatmap from /home/main/.krasis/models/Qwen3-235B-A22B/.krasis_cache/auto_heatmap.json: 7935 entries
2026-02-20 10:26:31,123 krasis.gpu_prefill INFO HCS unified VRAM budget: 1 devices, 9.7 MB/expert, per-device max experts: {'cuda:0': 462}, total max: 462
2026-02-20 10:26:31,125 krasis.gpu_prefill INFO HCS uniform allocation: 4 experts/layer across 94 layers = 376 total
2026-02-20 10:26:31,125 krasis.gpu_prefill INFO HCS assignment check: device 0 (cuda:0) â†’ 376 experts (budget: 462)
2026-02-20 10:26:31,126 krasis.gpu_prefill INFO HCS pre-load: cuda:0 allocated=11360 MB, free=4464 MB
2026-02-20 10:26:31,174 krasis.gpu_prefill INFO HCS load L0: total=39 MB | dev0: alloc=11397MB free=4406MB loaded=39MB(4exp)
2026-02-20 10:26:31,260 krasis.gpu_prefill INFO HCS load L6: total=272 MB | dev0: alloc=11620MB free=4182MB loaded=272MB(28exp)
2026-02-20 10:26:31,348 krasis.gpu_prefill INFO HCS load L12: total=506 MB | dev0: alloc=11843MB free=3960MB loaded=506MB(52exp)
2026-02-20 10:26:31,435 krasis.gpu_prefill INFO HCS load L18: total=740 MB | dev0: alloc=12066MB free=3736MB loaded=740MB(76exp)
2026-02-20 10:26:31,523 krasis.gpu_prefill INFO HCS load L24: total=973 MB | dev0: alloc=12289MB free=3514MB loaded=973MB(100exp)
2026-02-20 10:26:31,610 krasis.gpu_prefill INFO HCS load L30: total=1207 MB | dev0: alloc=12511MB free=3290MB loaded=1207MB(124exp)
2026-02-20 10:26:31,698 krasis.gpu_prefill INFO HCS load L36: total=1440 MB | dev0: alloc=12734MB free=3066MB loaded=1440MB(148exp)
2026-02-20 10:26:31,785 krasis.gpu_prefill INFO HCS load L42: total=1674 MB | dev0: alloc=12957MB free=2844MB loaded=1674MB(172exp)
2026-02-20 10:26:31,873 krasis.gpu_prefill INFO HCS load L48: total=1907 MB | dev0: alloc=13180MB free=2620MB loaded=1907MB(196exp)
2026-02-20 10:26:31,960 krasis.gpu_prefill INFO HCS load L54: total=2141 MB | dev0: alloc=13402MB free=2398MB loaded=2141MB(220exp)
2026-02-20 10:26:32,048 krasis.gpu_prefill INFO HCS load L60: total=2375 MB | dev0: alloc=13625MB free=2174MB loaded=2375MB(244exp)
2026-02-20 10:26:32,136 krasis.gpu_prefill INFO HCS load L66: total=2608 MB | dev0: alloc=13848MB free=1950MB loaded=2608MB(268exp)
2026-02-20 10:26:32,223 krasis.gpu_prefill INFO HCS load L72: total=2842 MB | dev0: alloc=14071MB free=1728MB loaded=2842MB(292exp)
2026-02-20 10:26:32,311 krasis.gpu_prefill INFO HCS load L78: total=3075 MB | dev0: alloc=14293MB free=1504MB loaded=3075MB(316exp)
2026-02-20 10:26:32,398 krasis.gpu_prefill INFO HCS load L84: total=3309 MB | dev0: alloc=14516MB free=1282MB loaded=3309MB(340exp)
2026-02-20 10:26:32,487 krasis.gpu_prefill INFO HCS load L90: total=3542 MB | dev0: alloc=14739MB free=1058MB loaded=3542MB(364exp)
2026-02-20 10:26:32,531 krasis.gpu_prefill INFO HCS load L93: total=3659 MB | dev0: alloc=14850MB free=946MB loaded=3659MB(376exp)
2026-02-20 10:26:32,685 krasis.gpu_prefill INFO hot_cached_static initialized: 376 experts across 1 devices, 3659.3 MB in 1.41s. Counts: {'cuda:0': 376}
2026-02-20 10:26:32,775 krasis.server CRITICAL Uncaught exception
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/main/Documents/Claude/krasis/python/krasis/server.py", line 680, in <module>
    main()
  File "/home/main/Documents/Claude/krasis/python/krasis/server.py", line 523, in main
    manager._init_hot_cached_static(
  File "/home/main/Documents/Claude/krasis/python/krasis/gpu_prefill.py", line 2986, in _init_hot_cached_static
    self._init_cuda_graphs()
  File "/home/main/Documents/Claude/krasis/python/krasis/gpu_prefill.py", line 3762, in _init_cuda_graphs
    io["output"] = self._call_fused_moe(
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/home/main/Documents/Claude/krasis/python/krasis/gpu_prefill.py", line 627, in _call_fused_moe
    return fused_marlin_moe(
           ^^^^^^^^^^^^^^^^^
  File "/home/main/Documents/Claude/krasis/.venv/lib/python3.12/site-packages/torch/_ops.py", line 1255, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/main/sglang/python/sglang/srt/layers/moe/fused_moe_triton/fused_marlin_moe.py", line 145, in fused_marlin_moe
    intermediate_cache1 = torch.ops.sgl_kernel.moe_wna16_marlin_gemm.default(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/main/Documents/Claude/krasis/.venv/lib/python3.12/site-packages/torch/_ops.py", line 841, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 15.58 GiB of which 14.25 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.41 GiB is allocated by PyTorch, with 925.58 MiB allocated in private pools (e.g., CUDA Graphs), and 26.84 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/main/Documents/Claude/krasis/python/krasis/server.py", line 680, in <module>
    main()
  File "/home/main/Documents/Claude/krasis/python/krasis/server.py", line 523, in main
    manager._init_hot_cached_static(
  File "/home/main/Documents/Claude/krasis/python/krasis/gpu_prefill.py", line 2986, in _init_hot_cached_static
    self._init_cuda_graphs()
  File "/home/main/Documents/Claude/krasis/python/krasis/gpu_prefill.py", line 3762, in _init_cuda_graphs
    io["output"] = self._call_fused_moe(
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/home/main/Documents/Claude/krasis/python/krasis/gpu_prefill.py", line 627, in _call_fused_moe
    return fused_marlin_moe(
           ^^^^^^^^^^^^^^^^^
  File "/home/main/Documents/Claude/krasis/.venv/lib/python3.12/site-packages/torch/_ops.py", line 1255, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/main/sglang/python/sglang/srt/layers/moe/fused_moe_triton/fused_marlin_moe.py", line 145, in fused_marlin_moe
    intermediate_cache1 = torch.ops.sgl_kernel.moe_wna16_marlin_gemm.default(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/main/Documents/Claude/krasis/.venv/lib/python3.12/site-packages/torch/_ops.py", line 841, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 15.58 GiB of which 14.25 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.41 GiB is allocated by PyTorch, with 925.58 MiB allocated in private pools (e.g., CUDA Graphs), and 26.84 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
