
[1m[36m‚ñ∏ Loading model weights[0m

[1m[36m‚ñ∏ Loading GPU weights[0m

[1m[36m‚ñ∏ Loading CPU expert weights[0m

[1m[36m‚ñ∏ Initializing GPU prefill managers[0m

[1m[36m‚ñ∏ Loading cached heatmap[0m

[1m[36m‚ñ∏ Warming up CUDA runtime[0m

[1m[36m‚ñ∏ Allocating HCS expert cache[0m

[1m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  KRASIS BENCHMARK
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê[0m

[1m[36m‚ñ∏ Collecting system info[0m
  Model:    [1mgpt-oss-120b[0m
  GPUs:     3x NVIDIA RTX 2000 Ada Generation
  Strategy: gpu_decode (hot_cached_static)

[1m[36m‚ñ∏ Loading benchmark prompts[0m
  Prefill: 10,000 tokens
  Decode:  81 tokens

[1m[36m‚ñ∏ Warmup (2 short generations)[0m
  Warmup: 2 short generations...
  Warmup complete.

[1m[36m‚ñ∏ Running prefill benchmark (10,000 tokens, 3 runs)[0m
  Run 1: 516.6 tok/s, TTFT=19.36s
  Run 2: 516.6 tok/s, TTFT=19.36s
  Run 3: 515.0 tok/s, TTFT=19.42s
  [1mAverage: 516.1 tok/s, TTFT=19.38s[0m

[1m[36m‚ñ∏ Running decode benchmark (64 tokens, 3 runs)[0m
  Run 1: 3.58 tok/s (279.6ms/tok)
  Run 2: 3.60 tok/s (277.4ms/tok)
  Run 3: 3.58 tok/s (279.1ms/tok)
  [1mAverage: 3.59 tok/s (278.7ms/tok)[0m

[1m[36m‚ñ∏ Writing results[0m

[1m‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  BENCHMARK COMPLETE
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[0m
  Prefill: [32m[1m516.1 tok/s[0m  TTFT=19.38s
  Decode:  [32m[1m3.59 tok/s[0m  (278.7ms/tok)
  Log:     [2mbenchmarks/gpt-oss-120b_native_1gpu_int8gpu_int8cpu.log[0m



--- STDERR ---
2026-02-20 09:54:49,310 krasis.server INFO Logging to /home/main/Documents/Claude/krasis/krasis.log
2026-02-20 09:54:49,311 krasis.server INFO HCS strategy: PP=1, 1 GPUs available
2026-02-20 09:54:49,311 krasis.model INFO KrasisModel: 36 layers, PP=[36], 1 GPUs, attn=flashinfer, hybrid=36 full + 0 linear
2026-02-20 09:54:49,311 krasis.server INFO ‚îÄ‚îÄ Loading model weights ‚îÄ‚îÄ
2026-02-20 09:54:49,311 krasis.model INFO RAM budget: experts=116.4 GB, overhead=20.0 GB, total=136.4 GB needed | system: 995.5 GB total, 955.9 GB available
2026-02-20 09:54:49,311 krasis.model INFO RAM budget OK: 136.4 GB needed, 859.1 GB headroom
2026-02-20 09:54:49,312 krasis.model INFO RAM watchdog started: will exit if < 5.0% free
2026-02-20 09:54:49,312 krasis.model INFO Phase 1: Loading GPU weights (streaming INT8)...
2026-02-20 09:54:49,451 krasis.model INFO Loading full base model to primary device cuda:0...
2026-02-20 09:54:49,452 krasis.weight_loader INFO Loading embedding: model.embed_tokens.weight
2026-02-20 09:54:49,725 krasis.weight_loader INFO Layer 0 loaded in 0.1s (GPU alloc: 1131 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:49,856 krasis.weight_loader INFO Layer 1 loaded in 0.1s (GPU alloc: 1297 MB, moe=True, type=full_attention)
2026-02-20 09:54:49,976 krasis.weight_loader INFO Layer 2 loaded in 0.1s (GPU alloc: 1333 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:50,096 krasis.weight_loader INFO Layer 3 loaded in 0.1s (GPU alloc: 1370 MB, moe=True, type=full_attention)
2026-02-20 09:54:50,216 krasis.weight_loader INFO Layer 4 loaded in 0.1s (GPU alloc: 1407 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:50,338 krasis.weight_loader INFO Layer 5 loaded in 0.1s (GPU alloc: 1444 MB, moe=True, type=full_attention)
2026-02-20 09:54:50,454 krasis.weight_loader INFO Layer 6 loaded in 0.1s (GPU alloc: 1481 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:50,569 krasis.weight_loader INFO Layer 7 loaded in 0.1s (GPU alloc: 1518 MB, moe=True, type=full_attention)
2026-02-20 09:54:50,687 krasis.weight_loader INFO Layer 8 loaded in 0.1s (GPU alloc: 1554 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:50,805 krasis.weight_loader INFO Layer 9 loaded in 0.1s (GPU alloc: 1591 MB, moe=True, type=full_attention)
2026-02-20 09:54:50,924 krasis.weight_loader INFO Layer 10 loaded in 0.1s (GPU alloc: 1628 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:51,043 krasis.weight_loader INFO Layer 11 loaded in 0.1s (GPU alloc: 1665 MB, moe=True, type=full_attention)
2026-02-20 09:54:51,163 krasis.weight_loader INFO Layer 12 loaded in 0.1s (GPU alloc: 1702 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:51,284 krasis.weight_loader INFO Layer 13 loaded in 0.1s (GPU alloc: 1739 MB, moe=True, type=full_attention)
2026-02-20 09:54:51,405 krasis.weight_loader INFO Layer 14 loaded in 0.1s (GPU alloc: 1776 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:51,526 krasis.weight_loader INFO Layer 15 loaded in 0.1s (GPU alloc: 1813 MB, moe=True, type=full_attention)
2026-02-20 09:54:51,647 krasis.weight_loader INFO Layer 16 loaded in 0.1s (GPU alloc: 1849 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:51,767 krasis.weight_loader INFO Layer 17 loaded in 0.1s (GPU alloc: 1886 MB, moe=True, type=full_attention)
2026-02-20 09:54:51,887 krasis.weight_loader INFO Layer 18 loaded in 0.1s (GPU alloc: 1923 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:52,007 krasis.weight_loader INFO Layer 19 loaded in 0.1s (GPU alloc: 1960 MB, moe=True, type=full_attention)
2026-02-20 09:54:52,127 krasis.weight_loader INFO Layer 20 loaded in 0.1s (GPU alloc: 1997 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:52,245 krasis.weight_loader INFO Layer 21 loaded in 0.1s (GPU alloc: 2034 MB, moe=True, type=full_attention)
2026-02-20 09:54:52,365 krasis.weight_loader INFO Layer 22 loaded in 0.1s (GPU alloc: 2071 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:52,484 krasis.weight_loader INFO Layer 23 loaded in 0.1s (GPU alloc: 2108 MB, moe=True, type=full_attention)
2026-02-20 09:54:52,603 krasis.weight_loader INFO Layer 24 loaded in 0.1s (GPU alloc: 2144 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:52,722 krasis.weight_loader INFO Layer 25 loaded in 0.1s (GPU alloc: 2181 MB, moe=True, type=full_attention)
2026-02-20 09:54:52,841 krasis.weight_loader INFO Layer 26 loaded in 0.1s (GPU alloc: 2218 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:52,959 krasis.weight_loader INFO Layer 27 loaded in 0.1s (GPU alloc: 2255 MB, moe=True, type=full_attention)
2026-02-20 09:54:53,078 krasis.weight_loader INFO Layer 28 loaded in 0.1s (GPU alloc: 2292 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:53,196 krasis.weight_loader INFO Layer 29 loaded in 0.1s (GPU alloc: 2329 MB, moe=True, type=full_attention)
2026-02-20 09:54:53,315 krasis.weight_loader INFO Layer 30 loaded in 0.1s (GPU alloc: 2366 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:53,432 krasis.weight_loader INFO Layer 31 loaded in 0.1s (GPU alloc: 2403 MB, moe=True, type=full_attention)
2026-02-20 09:54:53,551 krasis.weight_loader INFO Layer 32 loaded in 0.1s (GPU alloc: 2439 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:53,669 krasis.weight_loader INFO Layer 33 loaded in 0.1s (GPU alloc: 2476 MB, moe=True, type=full_attention)
2026-02-20 09:54:53,786 krasis.weight_loader INFO Layer 34 loaded in 0.1s (GPU alloc: 2513 MB, moe=True, type=sliding_attention)
2026-02-20 09:54:53,904 krasis.weight_loader INFO Layer 35 loaded in 0.1s (GPU alloc: 2550 MB, moe=True, type=full_attention)
2026-02-20 09:54:53,912 krasis.weight_loader INFO Loading final norm: model.norm.weight
2026-02-20 09:54:53,913 krasis.weight_loader INFO Loading LM head: lm_head.weight (precision=int8)
2026-02-20 09:54:56,100 krasis.model INFO GPU0: 3113 MB allocated
2026-02-20 09:54:56,100 krasis.model INFO GPU weights loaded in 6.8s
2026-02-20 09:54:56,100 krasis.model INFO Phase 2: Loading CPU expert weights (Krasis INT4)...
2026-02-20 09:57:40,334 krasis.model INFO Krasis engine: 36 MoE layers, 128 experts, hidden=2880
2026-02-20 09:57:40,367 krasis.model INFO Routing weights sent to Rust engine (36 MoE layers)
2026-02-20 09:57:40,367 krasis.model INFO CPU experts loaded in 164.3s
2026-02-20 09:57:40,367 krasis.model WARNING RAM estimate deviation: estimated 116.4 GB, actual VmRSS 222.6 GB (91% off) ‚Äî estimates may need recalibration
2026-02-20 09:57:40,367 krasis.gpu_prefill INFO GpuPrefillManager(rank 0/1): expert_slice=[0, 128), local_count=128
2026-02-20 09:57:40,367 krasis.gpu_prefill INFO GPU prefill group_size=64
2026-02-20 09:57:40,368 krasis.gpu_prefill INFO Marlin w2 padded N: 2880 ‚Üí 2944 (kernel compat)
2026-02-20 09:57:40,368 krasis.gpu_prefill INFO Auto chunk_size: 128 experts (25.9 MB each, 5231.2 MB budget of 13340.2 MB free)
2026-02-20 09:57:40,368 krasis.gpu_prefill INFO Hot-cached-static mode: hot experts on GPU (static), cold on CPU (parallel)
2026-02-20 09:57:40,368 krasis.gpu_prefill INFO GpuPrefillManager(engine): experts=128, hidden=2880, intermediate=2880, chunk_size=128, num_chunks=1, shared=0, scale=1.000, num_bits=8, prefill_mode=hot_cached_static, expert_divisor=-3
2026-02-20 09:57:40,368 krasis.model INFO GPU prefill manager created for cuda:0 (rank 0/1)
2026-02-20 09:57:40,419 krasis.gpu_prefill INFO Loaded expert biases: 36 layers, 79.6 MB on cuda:0
2026-02-20 09:57:40,419 krasis.gpu_prefill INFO Engine path: Marlin-native DMA copy (zero conversion, zero RAM cache)
2026-02-20 09:57:40,419 krasis.model INFO GPU prefill: 1 managers, threshold=1 tokens
2026-02-20 09:57:40,419 krasis.kv_cache INFO KV cache: 2000 MB ‚Üí 3555 pages (56.9K tokens)
2026-02-20 09:57:40,423 krasis.kv_cache INFO KV cache allocated: 36 layers √ó 3555 pages √ó 16 tokens = 2000 MB (gqa, gqa-split)
2026-02-20 09:57:40,423 krasis.model INFO Hybrid model: 36 full attention layers (KV cache), 0 linear attention layers
2026-02-20 09:57:41,335 krasis.tokenizer INFO Tokenizer loaded: vocab=199998, eos=200002, bos=199998
2026-02-20 09:57:41,335 krasis.model INFO Model fully loaded in 172.0s
2026-02-20 09:57:41,335 krasis.server INFO ‚îÄ‚îÄ Loading cached heatmap ‚îÄ‚îÄ
2026-02-20 09:57:41,335 krasis.server INFO Using cached heatmap: /home/main/.krasis/models/gpt-oss-120b/.krasis_cache/auto_heatmap.json
2026-02-20 09:57:41,335 krasis.server INFO ‚îÄ‚îÄ Warming up CUDA runtime ‚îÄ‚îÄ
2026-02-20 09:57:41,336 krasis.model INFO Warming up CUDA runtime on all devices: ['cuda:0']
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.cudart module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.runtime module instead.
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.nvrtc module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.nvrtc module instead.
2026-02-20 09:57:45,042 krasis.model WARNING CUDA warmup (Triton/Marlin) on cuda:0 failed: size_k = 2880, is not divisible by b_scales.size(1) = 22
2026-02-20 09:57:45,044 krasis.linear_attention INFO Compiled linear attention chunk step (default/Inductor mode)
2026-02-20 09:57:45,688 krasis.linear_attention INFO Linear attention torch.compile warmup complete on cuda:0
2026-02-20 09:57:45,980 krasis.model INFO CUDA runtime warmup on cuda:0 complete: 73 MB consumed (11163 MB free before ‚Üí 11090 MB free after)
2026-02-20 09:57:45,980 krasis.server INFO ‚îÄ‚îÄ Allocating HCS expert cache ‚îÄ‚îÄ
2026-02-20 09:57:45,980 krasis.server INFO Unified HCS: initializing with devices: ['cuda:0']
2026-02-20 09:57:46,057 krasis.server INFO Test prompt: 10000 tokens
2026-02-20 09:57:46,354 krasis.gpu_prefill INFO HCS state cleared.
2026-02-20 09:57:46,357 krasis.gpu_prefill INFO Loaded heatmap from /home/main/.krasis/models/gpt-oss-120b/.krasis_cache/auto_heatmap.json: 4143 entries
2026-02-20 09:57:46,358 krasis.gpu_prefill INFO HCS unified VRAM budget: 1 devices, 25.9 MB/expert, per-device max experts: {'cuda:0': 215}, total max: 215
2026-02-20 09:57:46,359 krasis.gpu_prefill INFO HCS uniform allocation: 5 experts/layer across 36 layers = 180 total
2026-02-20 09:57:46,360 krasis.gpu_prefill INFO HCS assignment check: device 0 (cuda:0) ‚Üí 180 experts (budget: 215)
2026-02-20 09:57:46,360 krasis.gpu_prefill INFO HCS pre-load: cuda:0 allocated=5198 MB, free=10616 MB
2026-02-20 09:57:46,533 krasis.gpu_prefill INFO HCS load L0: total=129 MB | dev0: alloc=5322MB free=10452MB loaded=129MB(5exp)
2026-02-20 09:57:47,606 krasis.gpu_prefill INFO HCS load L6: total=905 MB | dev0: alloc=6070MB free=9720MB loaded=905MB(35exp)
2026-02-20 09:57:48,680 krasis.gpu_prefill INFO HCS load L12: total=1680 MB | dev0: alloc=6817MB free=8968MB loaded=1680MB(65exp)
2026-02-20 09:57:49,749 krasis.gpu_prefill INFO HCS load L18: total=2456 MB | dev0: alloc=7565MB free=8216MB loaded=2456MB(95exp)
2026-02-20 09:57:50,816 krasis.gpu_prefill INFO HCS load L24: total=3231 MB | dev0: alloc=8312MB free=7462MB loaded=3231MB(125exp)
2026-02-20 09:57:51,886 krasis.gpu_prefill INFO HCS load L30: total=4007 MB | dev0: alloc=9060MB free=6730MB loaded=4007MB(155exp)
2026-02-20 09:57:52,778 krasis.gpu_prefill INFO HCS load L35: total=4653 MB | dev0: alloc=9683MB free=6100MB loaded=4653MB(180exp)
2026-02-20 09:57:52,832 krasis.gpu_prefill INFO hot_cached_static initialized: 180 experts across 1 devices, 4653.2 MB in 6.42s. Counts: {'cuda:0': 180}
2026-02-20 09:57:52,996 krasis.gpu_prefill INFO CUDA graphs captured: 36 MoE layers
2026-02-20 09:57:53,009 krasis.server INFO HCS calibration: 180 experts, 5316 MB consumed (free: 10616 ‚Üí 5300 MB)
2026-02-20 09:57:53,012 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:57:53,013 krasis.gpu_prefill INFO Pre-allocating pinned DMA buffers: 3308.9 MB (w13p=2123.4, w13s=66.4, w2p=1085.3, w2s=33.9)
2026-02-20 09:57:56,333 krasis.gpu_prefill INFO Pinned DMA buffers allocated: 3308.9 MB in 3.3s (one-time cost)
2026-02-20 09:57:56,862 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13523.6 MB)
2026-02-20 09:57:57,746 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13583.1 MB)
2026-02-20 09:57:58,544 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13583.8 MB)
2026-02-20 09:57:59,282 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13585.1 MB)
2026-02-20 09:58:00,050 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13586.4 MB)
2026-02-20 09:58:00,787 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13587.7 MB)
2026-02-20 09:58:01,567 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13588.9 MB)
2026-02-20 09:58:02,301 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13590.2 MB)
2026-02-20 09:58:03,077 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13591.5 MB)
2026-02-20 09:58:03,813 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13592.8 MB)
2026-02-20 09:58:04,584 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13594.1 MB)
2026-02-20 09:58:05,308 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.52s (GPU total: 13595.4 MB)
2026-02-20 09:58:06,081 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13596.6 MB)
2026-02-20 09:58:06,817 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13597.9 MB)
2026-02-20 09:58:07,587 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13599.2 MB)
2026-02-20 09:58:08,323 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13600.5 MB)
2026-02-20 09:58:09,098 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13601.8 MB)
2026-02-20 09:58:09,836 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13603.1 MB)
2026-02-20 09:58:10,614 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13604.3 MB)
2026-02-20 09:58:11,351 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13605.6 MB)
2026-02-20 09:58:12,118 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13606.9 MB)
2026-02-20 09:58:12,860 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13608.2 MB)
2026-02-20 09:58:13,631 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13609.5 MB)
2026-02-20 09:58:14,371 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13610.8 MB)
2026-02-20 09:58:15,143 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13612.0 MB)
2026-02-20 09:58:15,880 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13613.3 MB)
2026-02-20 09:58:16,653 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13614.6 MB)
2026-02-20 09:58:17,399 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13615.9 MB)
2026-02-20 09:58:18,173 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13617.2 MB)
2026-02-20 09:58:18,911 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13618.5 MB)
2026-02-20 09:58:19,692 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13619.8 MB)
2026-02-20 09:58:20,437 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13621.0 MB)
2026-02-20 09:58:21,215 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13622.3 MB)
2026-02-20 09:58:21,962 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13623.6 MB)
2026-02-20 09:58:22,741 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13624.9 MB)
2026-02-20 09:58:23,485 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.54s (GPU total: 13626.2 MB)
2026-02-20 09:58:24,154 krasis.gpu_prefill INFO GPU validation PASS: 180 experts, 5300 MB free after load, inference cost 4180 MB (peak 13908 MB, baseline 9727 MB)
2026-02-20 09:58:24,155 krasis.server INFO Inference cost on cuda:0: 4180 MB (transient)
2026-02-20 09:58:24,155 krasis.server INFO Per-expert cost: 30967944 bytes total (25850880 data + 5117064 overhead), HCS overhead: 878 MB (workspace + g_idx/sort_idx)
2026-02-20 09:58:24,540 krasis.gpu_prefill INFO HCS state cleared.
2026-02-20 09:58:24,540 krasis.server INFO GPU cuda:0: 10530 MB free, reserved=4692 MB (inference=4180 + margin=512), budget=4856 MB (197 max experts)
2026-02-20 09:58:24,816 krasis.gpu_prefill INFO HCS state cleared.
2026-02-20 09:58:24,819 krasis.gpu_prefill INFO Loaded heatmap from /home/main/.krasis/models/gpt-oss-120b/.krasis_cache/auto_heatmap.json: 4143 entries
2026-02-20 09:58:24,820 krasis.gpu_prefill INFO HCS unified VRAM budget: 1 devices, 25.9 MB/expert, per-device max experts: {'cuda:0': 196}, total max: 196
2026-02-20 09:58:24,820 krasis.gpu_prefill INFO HCS assignment check: device 0 (cuda:0) ‚Üí 196 experts (budget: 196)
2026-02-20 09:58:24,821 krasis.gpu_prefill INFO HCS pre-load: cuda:0 allocated=5242 MB, free=10530 MB
2026-02-20 09:58:25,063 krasis.gpu_prefill INFO HCS load L0: total=181 MB | dev0: alloc=5415MB free=10338MB loaded=181MB(7exp)
2026-02-20 09:58:25,224 krasis.gpu_prefill INFO HCS load L6: total=336 MB | dev0: alloc=5564MB free=10182MB loaded=336MB(13exp)
2026-02-20 09:58:25,674 krasis.gpu_prefill INFO HCS load L12: total=801 MB | dev0: alloc=6012MB free=9732MB loaded=801MB(31exp)
2026-02-20 09:58:27,034 krasis.gpu_prefill INFO HCS load L18: total=1784 MB | dev0: alloc=6953MB free=8788MB loaded=1784MB(69exp)
2026-02-20 09:58:28,509 krasis.gpu_prefill INFO HCS load L24: total=2844 MB | dev0: alloc=7966MB free=7772MB loaded=2844MB(110exp)
2026-02-20 09:58:30,152 krasis.gpu_prefill INFO HCS load L30: total=4033 MB | dev0: alloc=9101MB free=6614MB loaded=4033MB(156exp)
2026-02-20 09:58:31,587 krasis.gpu_prefill INFO HCS load L35: total=5067 MB | dev0: alloc=10089MB free=5624MB loaded=5067MB(196exp)
2026-02-20 09:58:31,639 krasis.gpu_prefill INFO hot_cached_static initialized: 196 experts across 1 devices, 5066.8 MB in 6.77s. Counts: {'cuda:0': 196}
2026-02-20 09:58:31,704 krasis.gpu_prefill INFO CUDA graphs captured: 34 MoE layers
2026-02-20 09:58:31,728 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:58:32,254 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13949.6 MB)
2026-02-20 09:58:32,990 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.7 MB)
2026-02-20 09:58:33,767 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:34,503 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:35,268 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.52s (GPU total: 14007.2 MB)
2026-02-20 09:58:36,003 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:36,780 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:37,517 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:38,295 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:39,028 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:39,799 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:40,529 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.52s (GPU total: 14007.2 MB)
2026-02-20 09:58:41,307 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:42,045 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:42,822 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:43,562 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:44,339 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:45,075 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:45,852 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:46,590 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:47,362 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:48,094 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:48,868 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:49,597 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:50,367 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:51,097 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:51,872 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.54s (GPU total: 14007.2 MB)
2026-02-20 09:58:52,611 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:53,380 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:54,112 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:54,883 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.54s (GPU total: 14007.2 MB)
2026-02-20 09:58:55,621 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:56,399 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:57,136 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.54s (GPU total: 14007.2 MB)
2026-02-20 09:58:57,911 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:58,646 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 14007.2 MB)
2026-02-20 09:58:59,240 krasis.gpu_prefill INFO GPU validation PASS: 196 experts, 4914 MB free after load, inference cost 4181 MB (peak 14271 MB, baseline 10089 MB)
2026-02-20 09:58:59,240 krasis.server INFO HCS ready: 196 experts across 1 GPUs, margin=733 MB (free=4914, cost=4181). Counts: {'cuda:0': 196}
2026-02-20 09:58:59,407 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:58:59,408 krasis.model INFO DMA pipelining ENABLED (1 managers, 36 groups)
2026-02-20 09:58:59,934 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13892.3 MB)
2026-02-20 09:59:20,771 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:59:20,772 krasis.model INFO DMA pipelining ENABLED (1 managers, 36 groups)
2026-02-20 09:59:21,298 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13892.2 MB)
2026-02-20 09:59:41,857 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 09:59:41,857 krasis.model INFO DMA pipelining ENABLED (1 managers, 36 groups)
2026-02-20 09:59:42,384 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13949.5 MB)
2026-02-20 10:00:01,219 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 10:00:01,219 krasis.model INFO DMA pipelining ENABLED (1 managers, 36 groups)
2026-02-20 10:00:01,747 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13949.6 MB)
2026-02-20 10:00:20,577 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 10:00:20,577 krasis.model INFO DMA pipelining ENABLED (1 managers, 36 groups)
2026-02-20 10:00:21,107 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13949.6 MB)
2026-02-20 10:00:39,993 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 10:00:39,993 krasis.model INFO DMA pipelining ENABLED (1 managers, 36 groups)
2026-02-20 10:00:40,523 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13892.3 MB)
2026-02-20 10:01:17,015 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 10:01:17,016 krasis.model INFO DMA pipelining ENABLED (1 managers, 36 groups)
2026-02-20 10:01:17,542 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.52s (GPU total: 13892.2 MB)
2026-02-20 10:01:53,911 krasis.model INFO HCS prefill: 36 MoE layers, 1-layer groups (maximize chunk size)
2026-02-20 10:01:53,911 krasis.model INFO DMA pipelining ENABLED (1 managers, 36 groups)
2026-02-20 10:01:54,438 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 3308.9 MB in 0.53s (GPU total: 13892.2 MB)
