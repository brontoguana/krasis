2026-02-21 01:09:40,596 krasis.server INFO Logging to /home/main/Documents/Claude/krasis/krasis.log
2026-02-21 01:09:40,596 krasis.server INFO HCS strategy: PP=1, 2 GPUs available
2026-02-21 01:09:40,596 krasis.model INFO KrasisModel: 48 layers, PP=[48], 1 GPUs, attn=flashinfer, hybrid=12 full + 36 linear

[1m[36m‚ñ∏ Loading model weights[0m
2026-02-21 01:09:40,641 krasis.server INFO ‚îÄ‚îÄ Loading model weights ‚îÄ‚îÄ
2026-02-21 01:09:40,641 krasis.model INFO RAM budget: experts=39.9 GB, overhead=20.0 GB, total=59.9 GB needed | system: 995.5 GB total, 956.6 GB available
2026-02-21 01:09:40,641 krasis.model INFO RAM budget OK: 59.9 GB needed, 935.6 GB headroom
2026-02-21 01:09:40,642 krasis.model INFO RAM watchdog started: will exit if < 5.0% free

[1m[36m‚ñ∏ Loading GPU weights[0m
2026-02-21 01:09:40,642 krasis.model INFO Phase 1: Loading GPU weights (streaming INT8)...
2026-02-21 01:09:40,800 krasis.model INFO Streaming attention: all 48 layers on GPU0, 2 GPUs for EP
2026-02-21 01:09:40,800 krasis.model INFO Loading full base model to cuda:0...
2026-02-21 01:09:40,800 krasis.weight_loader INFO Loading embedding: model.embed_tokens.weight
2026-02-21 01:09:41,058 krasis.weight_loader INFO Layer 0 loaded in 0.2s (GPU alloc: 631 MB, moe=True, type=linear_attention)
2026-02-21 01:09:41,214 krasis.weight_loader INFO Layer 1 loaded in 0.1s (GPU alloc: 672 MB, moe=True, type=linear_attention)
2026-02-21 01:09:41,357 krasis.weight_loader INFO Layer 2 loaded in 0.1s (GPU alloc: 714 MB, moe=True, type=linear_attention)
2026-02-21 01:09:41,473 krasis.weight_loader INFO Layer 3 loaded in 0.1s (GPU alloc: 749 MB, moe=True, type=full_attention)
2026-02-21 01:09:41,474 krasis.attention INFO Layer 3: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:41,628 krasis.weight_loader INFO Layer 4 loaded in 0.1s (GPU alloc: 926 MB, moe=True, type=linear_attention)
2026-02-21 01:09:41,774 krasis.weight_loader INFO Layer 5 loaded in 0.1s (GPU alloc: 967 MB, moe=True, type=linear_attention)
2026-02-21 01:09:41,922 krasis.weight_loader INFO Layer 6 loaded in 0.1s (GPU alloc: 1009 MB, moe=True, type=linear_attention)
2026-02-21 01:09:42,039 krasis.weight_loader INFO Layer 7 loaded in 0.1s (GPU alloc: 1044 MB, moe=True, type=full_attention)
2026-02-21 01:09:42,039 krasis.attention INFO Layer 7: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:42,195 krasis.weight_loader INFO Layer 8 loaded in 0.1s (GPU alloc: 1093 MB, moe=True, type=linear_attention)
2026-02-21 01:09:42,344 krasis.weight_loader INFO Layer 9 loaded in 0.1s (GPU alloc: 1134 MB, moe=True, type=linear_attention)
2026-02-21 01:09:42,494 krasis.weight_loader INFO Layer 10 loaded in 0.1s (GPU alloc: 1175 MB, moe=True, type=linear_attention)
2026-02-21 01:09:42,617 krasis.weight_loader INFO Layer 11 loaded in 0.1s (GPU alloc: 1210 MB, moe=True, type=full_attention)
2026-02-21 01:09:42,618 krasis.attention INFO Layer 11: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:42,775 krasis.weight_loader INFO Layer 12 loaded in 0.1s (GPU alloc: 1260 MB, moe=True, type=linear_attention)
2026-02-21 01:09:42,923 krasis.weight_loader INFO Layer 13 loaded in 0.1s (GPU alloc: 1301 MB, moe=True, type=linear_attention)
2026-02-21 01:09:43,073 krasis.weight_loader INFO Layer 14 loaded in 0.1s (GPU alloc: 1342 MB, moe=True, type=linear_attention)
2026-02-21 01:09:43,193 krasis.weight_loader INFO Layer 15 loaded in 0.1s (GPU alloc: 1377 MB, moe=True, type=full_attention)
2026-02-21 01:09:43,193 krasis.attention INFO Layer 15: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:43,343 krasis.weight_loader INFO Layer 16 loaded in 0.1s (GPU alloc: 1427 MB, moe=True, type=linear_attention)
2026-02-21 01:09:43,485 krasis.weight_loader INFO Layer 17 loaded in 0.1s (GPU alloc: 1468 MB, moe=True, type=linear_attention)
2026-02-21 01:09:43,624 krasis.weight_loader INFO Layer 18 loaded in 0.1s (GPU alloc: 1509 MB, moe=True, type=linear_attention)
2026-02-21 01:09:43,738 krasis.weight_loader INFO Layer 19 loaded in 0.1s (GPU alloc: 1544 MB, moe=True, type=full_attention)
2026-02-21 01:09:43,738 krasis.attention INFO Layer 19: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:43,887 krasis.weight_loader INFO Layer 20 loaded in 0.1s (GPU alloc: 1594 MB, moe=True, type=linear_attention)
2026-02-21 01:09:44,029 krasis.weight_loader INFO Layer 21 loaded in 0.1s (GPU alloc: 1635 MB, moe=True, type=linear_attention)
2026-02-21 01:09:44,171 krasis.weight_loader INFO Layer 22 loaded in 0.1s (GPU alloc: 1676 MB, moe=True, type=linear_attention)
2026-02-21 01:09:44,284 krasis.weight_loader INFO Layer 23 loaded in 0.1s (GPU alloc: 1711 MB, moe=True, type=full_attention)
2026-02-21 01:09:44,284 krasis.attention INFO Layer 23: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:44,432 krasis.weight_loader INFO Layer 24 loaded in 0.1s (GPU alloc: 1760 MB, moe=True, type=linear_attention)
2026-02-21 01:09:44,574 krasis.weight_loader INFO Layer 25 loaded in 0.1s (GPU alloc: 1802 MB, moe=True, type=linear_attention)
2026-02-21 01:09:44,716 krasis.weight_loader INFO Layer 26 loaded in 0.1s (GPU alloc: 1843 MB, moe=True, type=linear_attention)
2026-02-21 01:09:44,829 krasis.weight_loader INFO Layer 27 loaded in 0.1s (GPU alloc: 1878 MB, moe=True, type=full_attention)
2026-02-21 01:09:44,830 krasis.attention INFO Layer 27: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:44,979 krasis.weight_loader INFO Layer 28 loaded in 0.1s (GPU alloc: 1927 MB, moe=True, type=linear_attention)
2026-02-21 01:09:45,120 krasis.weight_loader INFO Layer 29 loaded in 0.1s (GPU alloc: 1969 MB, moe=True, type=linear_attention)
2026-02-21 01:09:45,260 krasis.weight_loader INFO Layer 30 loaded in 0.1s (GPU alloc: 2010 MB, moe=True, type=linear_attention)
2026-02-21 01:09:45,374 krasis.weight_loader INFO Layer 31 loaded in 0.1s (GPU alloc: 2045 MB, moe=True, type=full_attention)
2026-02-21 01:09:45,374 krasis.attention INFO Layer 31: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:45,523 krasis.weight_loader INFO Layer 32 loaded in 0.1s (GPU alloc: 2094 MB, moe=True, type=linear_attention)
2026-02-21 01:09:45,664 krasis.weight_loader INFO Layer 33 loaded in 0.1s (GPU alloc: 2135 MB, moe=True, type=linear_attention)
2026-02-21 01:09:45,807 krasis.weight_loader INFO Layer 34 loaded in 0.1s (GPU alloc: 2177 MB, moe=True, type=linear_attention)
2026-02-21 01:09:45,918 krasis.weight_loader INFO Layer 35 loaded in 0.1s (GPU alloc: 2212 MB, moe=True, type=full_attention)
2026-02-21 01:09:45,918 krasis.attention INFO Layer 35: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:46,067 krasis.weight_loader INFO Layer 36 loaded in 0.1s (GPU alloc: 2261 MB, moe=True, type=linear_attention)
2026-02-21 01:09:46,209 krasis.weight_loader INFO Layer 37 loaded in 0.1s (GPU alloc: 2302 MB, moe=True, type=linear_attention)
2026-02-21 01:09:46,349 krasis.weight_loader INFO Layer 38 loaded in 0.1s (GPU alloc: 2344 MB, moe=True, type=linear_attention)
2026-02-21 01:09:46,463 krasis.weight_loader INFO Layer 39 loaded in 0.1s (GPU alloc: 2379 MB, moe=True, type=full_attention)
2026-02-21 01:09:46,463 krasis.attention INFO Layer 39: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:46,611 krasis.weight_loader INFO Layer 40 loaded in 0.1s (GPU alloc: 2428 MB, moe=True, type=linear_attention)
2026-02-21 01:09:46,749 krasis.weight_loader INFO Layer 41 loaded in 0.1s (GPU alloc: 2469 MB, moe=True, type=linear_attention)
2026-02-21 01:09:46,891 krasis.weight_loader INFO Layer 42 loaded in 0.1s (GPU alloc: 2510 MB, moe=True, type=linear_attention)
2026-02-21 01:09:47,003 krasis.weight_loader INFO Layer 43 loaded in 0.1s (GPU alloc: 2545 MB, moe=True, type=full_attention)
2026-02-21 01:09:47,003 krasis.attention INFO Layer 43: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:47,152 krasis.weight_loader INFO Layer 44 loaded in 0.1s (GPU alloc: 2595 MB, moe=True, type=linear_attention)
2026-02-21 01:09:47,292 krasis.weight_loader INFO Layer 45 loaded in 0.1s (GPU alloc: 2636 MB, moe=True, type=linear_attention)
2026-02-21 01:09:47,433 krasis.weight_loader INFO Layer 46 loaded in 0.1s (GPU alloc: 2677 MB, moe=True, type=linear_attention)
2026-02-21 01:09:47,542 krasis.weight_loader INFO Layer 47 loaded in 0.1s (GPU alloc: 2712 MB, moe=True, type=full_attention)
2026-02-21 01:09:47,542 krasis.attention INFO Layer 47: gated attention detected (q_proj dim=8192, expected=4096)
2026-02-21 01:09:47,550 krasis.weight_loader INFO Loading final norm: model.norm.weight
2026-02-21 01:09:47,552 krasis.weight_loader INFO Loading LM head: lm_head.weight (precision=int8)
2026-02-21 01:09:48,634 krasis.model INFO VRAM[after-all-layers-loaded] GPU0: free=12783 MB, alloc=3021 MB, reserved=3042 MB, non-pytorch=132 MB
2026-02-21 01:09:48,764 krasis.model INFO VRAM[after-all-layers-loaded] GPU1: free=15857 MB, alloc=0 MB, reserved=0 MB, non-pytorch=100 MB
2026-02-21 01:09:49,003 krasis.model INFO GPU0: 3021 MB allocated
2026-02-21 01:09:49,004 krasis.model INFO GPU weights loaded in 8.4s

[1m[36m‚ñ∏ Loading CPU expert weights[0m
2026-02-21 01:09:49,004 krasis.model INFO Phase 2: Loading CPU expert weights (Krasis INT4)...
2026-02-21 01:09:49,004 krasis.model INFO shared_expert_gate detected ‚Äî Rust engine will skip shared experts (handled on GPU)
2026-02-21 01:10:41,344 krasis.model INFO Krasis engine: 48 MoE layers, 512 experts, hidden=2048
2026-02-21 01:10:41,434 krasis.model INFO Routing weights sent to Rust engine (48 MoE layers)
2026-02-21 01:10:41,434 krasis.model INFO CPU experts loaded in 52.4s
2026-02-21 01:10:41,434 krasis.model WARNING RAM estimate deviation: estimated 39.9 GB, actual VmRSS 76.1 GB (90% off) ‚Äî estimates may need recalibration

[1m[36m‚ñ∏ Initializing GPU prefill managers[0m
2026-02-21 01:10:41,434 krasis.gpu_prefill INFO GpuPrefillManager(rank 0/2): expert_slice=[0, 256), local_count=256
2026-02-21 01:10:41,434 krasis.gpu_prefill INFO GPU prefill group_size=128
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO Auto chunk_size: 512 experts (1.6 MB each, 5256.7 MB budget of 13403.9 MB free)
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO Hot-cached-static mode: hot experts on GPU (static), cold on CPU (parallel)
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO GpuPrefillManager(engine): experts=512, hidden=2048, intermediate=512, chunk_size=512, num_chunks=1, shared=1, scale=1.000, num_bits=4, prefill_mode=hot_cached_static, expert_divisor=-3
2026-02-21 01:10:41,435 krasis.model INFO GPU prefill manager created for cuda:0 (rank 0/2)
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO GpuPrefillManager(rank 1/2): expert_slice=[256, 512), local_count=256
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO GPU prefill group_size=128
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO Auto chunk_size: 512 experts (1.6 MB each, 6546.1 MB budget of 16627.3 MB free)
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO Hot-cached-static mode: hot experts on GPU (static), cold on CPU (parallel)
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO GpuPrefillManager(engine): experts=512, hidden=2048, intermediate=512, chunk_size=512, num_chunks=1, shared=1, scale=1.000, num_bits=4, prefill_mode=hot_cached_static, expert_divisor=-3
2026-02-21 01:10:41,435 krasis.model INFO GPU prefill manager created for cuda:1 (rank 1/2)
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO Engine path: Marlin-native DMA copy (zero conversion, zero RAM cache)
2026-02-21 01:10:41,435 krasis.gpu_prefill INFO Engine path: Marlin-native DMA copy (zero conversion, zero RAM cache)
2026-02-21 01:10:41,435 krasis.model INFO GPU prefill: 2 managers, threshold=1 tokens
2026-02-21 01:10:41,435 krasis.kv_cache INFO KV cache: 2000 MB ‚Üí 10666 pages (170.7K tokens)
2026-02-21 01:10:41,439 krasis.kv_cache INFO KV cache allocated: 12 layers √ó 10666 pages √ó 16 tokens = 2000 MB (gqa, gqa-split)
2026-02-21 01:10:41,439 krasis.model INFO Hybrid model: 12 full attention layers (KV cache), 36 linear attention layers
2026-02-21 01:10:41,526 krasis.model INFO CPU Hub initialized for 2 GPUs
2026-02-21 01:10:41,810 krasis.tokenizer INFO Tokenizer loaded: vocab=151643, eos=151645, bos=-1
2026-02-21 01:10:41,810 krasis.model INFO Model fully loaded in 61.2s

[1m[36m‚ñ∏ Loading cached heatmap[0m
2026-02-21 01:10:41,813 krasis.server INFO ‚îÄ‚îÄ Loading cached heatmap ‚îÄ‚îÄ
2026-02-21 01:10:41,813 krasis.server INFO Using cached heatmap: /home/main/.krasis/models/Qwen3-Coder-Next/.krasis_cache/auto_heatmap.json

[1m[36m‚ñ∏ Warming up CUDA runtime[0m
2026-02-21 01:10:41,813 krasis.server INFO ‚îÄ‚îÄ Warming up CUDA runtime ‚îÄ‚îÄ
2026-02-21 01:10:41,815 krasis.model INFO Warming up CUDA runtime on all devices: ['cuda:0', 'cuda:1']
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.cudart module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.runtime module instead.
<frozen importlib._bootstrap_external>:1297: FutureWarning: The cuda.nvrtc module is deprecated and will be removed in a future release, please switch to use the cuda.bindings.nvrtc module instead.
2026-02-21 01:10:45,972 krasis.model WARNING CUDA warmup (Triton/Marlin) on cuda:1 failed: w_packed shape torch.Size([1024, 256]) != (1024, 64)
2026-02-21 01:10:45,974 krasis.linear_attention INFO Compiled linear attention chunk step (default/Inductor mode)
2026-02-21 01:10:46,307 krasis.linear_attention INFO Linear attention torch.compile warmup complete on cuda:0
2026-02-21 01:10:46,609 krasis.model INFO CUDA runtime warmup on cuda:0 complete: 46 MB consumed (11307 MB free before ‚Üí 11261 MB free after)
2026-02-21 01:10:46,610 krasis.model INFO CUDA runtime warmup on cuda:1 complete: 36 MB consumed (16627 MB free before ‚Üí 16592 MB free after)

[1m[36m‚ñ∏ Allocating HCS expert cache[0m
2026-02-21 01:10:46,610 krasis.server INFO ‚îÄ‚îÄ Allocating HCS expert cache ‚îÄ‚îÄ
2026-02-21 01:10:46,610 krasis.server INFO Unified HCS: initializing with devices: ['cuda:0', 'cuda:1']
2026-02-21 01:10:46,668 krasis.server INFO Test prompt: 10000 tokens
2026-02-21 01:10:46,668 krasis.server INFO HCS multi-GPU: 2 devices, calibration on cuda:1 (free: cuda:0: 10739 MB, cuda:1: 15823 MB)
2026-02-21 01:10:46,974 krasis.gpu_prefill INFO HCS state cleared.
2026-02-21 01:10:47,261 krasis.gpu_prefill INFO HCS state cleared.
2026-02-21 01:10:47,273 krasis.gpu_prefill INFO Loaded heatmap from /home/main/.krasis/models/Qwen3-Coder-Next/.krasis_cache/auto_heatmap.json: 15923 entries
2026-02-21 01:10:47,277 krasis.gpu_prefill INFO HCS unified VRAM budget: 1 devices, 1.6 MB/expert, per-device max experts: {'cuda:1': 3413}, total max: 3413
2026-02-21 01:10:47,282 krasis.gpu_prefill INFO HCS uniform allocation: 71 experts/layer across 48 layers = 3408 total
2026-02-21 01:10:47,283 krasis.gpu_prefill INFO HCS assignment check: device 0 (cuda:1) ‚Üí 3408 experts (budget: 3413)
2026-02-21 01:10:47,283 krasis.gpu_prefill INFO HCS pre-load: cuda:1 allocated=0 MB, free=15845 MB
2026-02-21 01:10:47,440 krasis.gpu_prefill INFO HCS load L0: total=115 MB | dev0: alloc=111MB free=15693MB loaded=115MB(71exp)
2026-02-21 01:10:48,407 krasis.gpu_prefill INFO HCS load L6: total=806 MB | dev0: alloc=779MB free=15025MB loaded=806MB(497exp)
2026-02-21 01:10:49,377 krasis.gpu_prefill INFO HCS load L12: total=1497 MB | dev0: alloc=1447MB free=14357MB loaded=1497MB(923exp)
2026-02-21 01:10:50,347 krasis.gpu_prefill INFO HCS load L18: total=2188 MB | dev0: alloc=2115MB free=13689MB loaded=2188MB(1349exp)
2026-02-21 01:10:51,318 krasis.gpu_prefill INFO HCS load L24: total=2879 MB | dev0: alloc=2783MB free=13021MB loaded=2879MB(1775exp)
2026-02-21 01:10:52,289 krasis.gpu_prefill INFO HCS load L30: total=3570 MB | dev0: alloc=3451MB free=12353MB loaded=3570MB(2201exp)
2026-02-21 01:10:53,260 krasis.gpu_prefill INFO HCS load L36: total=4261 MB | dev0: alloc=4119MB free=11685MB loaded=4261MB(2627exp)
2026-02-21 01:10:54,232 krasis.gpu_prefill INFO HCS load L42: total=4952 MB | dev0: alloc=4787MB free=11017MB loaded=4952MB(3053exp)
2026-02-21 01:10:55,040 krasis.gpu_prefill INFO HCS load L47: total=5528 MB | dev0: alloc=5344MB free=10477MB loaded=5528MB(3408exp)
2026-02-21 01:10:55,362 krasis.gpu_prefill INFO hot_cached_static initialized: 3408 experts across 1 devices, 5527.8 MB in 7.76s. Counts: {'cuda:1': 3408}
2026-02-21 01:10:55,454 krasis.gpu_prefill INFO CUDA graphs captured: 48 MoE layers
2026-02-21 01:10:55,467 krasis.server INFO HCS calibration attempt 1 on cuda:1: 3408 experts, budget=5281 MB, 6432 MB consumed (free: 15845 ‚Üí 9413 MB)
2026-02-21 01:10:55,470 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:10:55,471 krasis.gpu_prefill INFO Pre-allocating pinned DMA buffers: 415.2 MB (w13p=268.4, w13s=8.4, w2p=134.2, w2s=4.2)
2026-02-21 01:10:55,471 krasis.gpu_prefill INFO Pre-allocating pinned DMA buffers: 415.2 MB (w13p=268.4, w13s=8.4, w2p=134.2, w2s=4.2)
2026-02-21 01:10:56,003 krasis.gpu_prefill INFO Pinned DMA buffers allocated: 415.2 MB in 0.5s (one-time cost)
2026-02-21 01:10:56,003 krasis.gpu_prefill INFO Pinned DMA buffers allocated: 415.2 MB in 0.5s (one-time cost)
2026-02-21 01:10:56,091 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6019.5 MB)
2026-02-21 01:10:56,092 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5731.4 MB)
2026-02-21 01:10:56,771 krasis.model WARNING GPU P2P transfer broken ‚Äî using CPU bounce for cross-device transfers
2026-02-21 01:10:57,055 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5868.3 MB)
2026-02-21 01:10:57,057 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:10:57,417 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5878.0 MB)
2026-02-21 01:10:57,419 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:10:57,778 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5888.7 MB)
2026-02-21 01:10:57,780 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:10:58,117 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5898.5 MB)
2026-02-21 01:10:58,120 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:10:58,479 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5910.2 MB)
2026-02-21 01:10:58,483 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:10:58,841 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5920.8 MB)
2026-02-21 01:10:58,843 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:10:59,202 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5931.0 MB)
2026-02-21 01:10:59,205 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:10:59,509 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5940.8 MB)
2026-02-21 01:10:59,512 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:10:59,872 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5951.5 MB)
2026-02-21 01:10:59,876 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:00,235 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5961.2 MB)
2026-02-21 01:11:00,239 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:00,601 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5971.9 MB)
2026-02-21 01:11:00,601 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:00,898 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5981.7 MB)
2026-02-21 01:11:00,902 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:01,261 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 5992.4 MB)
2026-02-21 01:11:01,262 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:01,621 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:01,623 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6003.1 MB)
2026-02-21 01:11:01,983 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6013.8 MB)
2026-02-21 01:11:01,986 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:02,287 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6023.6 MB)
2026-02-21 01:11:02,290 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:02,650 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6034.2 MB)
2026-02-21 01:11:02,653 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:03,013 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6044.9 MB)
2026-02-21 01:11:03,016 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:03,377 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6047.6 MB)
2026-02-21 01:11:03,380 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:03,680 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6056.9 MB)
2026-02-21 01:11:03,682 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:04,043 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6068.6 MB)
2026-02-21 01:11:04,045 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:04,405 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6069.7 MB)
2026-02-21 01:11:04,408 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:04,767 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6071.9 MB)
2026-02-21 01:11:04,770 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:05,069 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6082.2 MB)
2026-02-21 01:11:05,071 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:05,428 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6092.9 MB)
2026-02-21 01:11:05,430 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:05,790 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6094.5 MB)
2026-02-21 01:11:05,792 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:06,152 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6097.7 MB)
2026-02-21 01:11:06,154 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:06,455 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6107.0 MB)
2026-02-21 01:11:06,457 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:06,817 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6117.7 MB)
2026-02-21 01:11:06,819 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:07,180 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6120.3 MB)
2026-02-21 01:11:07,183 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:07,545 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6120.5 MB)
2026-02-21 01:11:07,546 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:07,849 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6132.8 MB)
2026-02-21 01:11:07,851 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:08,211 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6142.5 MB)
2026-02-21 01:11:08,215 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:08,577 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6144.2 MB)
2026-02-21 01:11:08,580 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:08,943 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6146.8 MB)
2026-02-21 01:11:08,946 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:09,249 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6157.1 MB)
2026-02-21 01:11:09,253 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:09,614 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6167.8 MB)
2026-02-21 01:11:09,616 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:09,978 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6169.5 MB)
2026-02-21 01:11:09,982 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:10,343 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6171.6 MB)
2026-02-21 01:11:10,347 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:10,649 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6171.9 MB)
2026-02-21 01:11:10,652 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:11,013 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6184.1 MB)
2026-02-21 01:11:11,016 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:11,375 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6184.8 MB)
2026-02-21 01:11:11,378 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:11,741 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6187.9 MB)
2026-02-21 01:11:11,743 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:12,046 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6189.2 MB)
2026-02-21 01:11:12,048 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:12,407 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6200.4 MB)
2026-02-21 01:11:12,411 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:12,774 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6202.1 MB)
2026-02-21 01:11:12,776 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:13,135 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6203.2 MB)
2026-02-21 01:11:13,137 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 6061.8 MB)
2026-02-21 01:11:13,753 krasis.gpu_prefill INFO GPU validation PASS: 3408 experts, 9413 MB free after load, inference cost 706 MB (peak 6051 MB, baseline 5344 MB)
2026-02-21 01:11:13,754 krasis.server INFO Inference cost on cuda:1: 706 MB (transient)
2026-02-21 01:11:13,754 krasis.server INFO Per-expert cost: 1979002 bytes total (1622016 data + 356986 overhead), HCS overhead: 1160 MB (workspace + g_idx/sort_idx)
2026-02-21 01:11:14,186 krasis.gpu_prefill INFO HCS state cleared.
2026-02-21 01:11:14,186 krasis.server INFO HCS GPU cuda:0: 9323 MB free, reserved=2630 MB (inference=2118 + margin=512), budget=5485 MB (3546 max experts)
2026-02-21 01:11:14,186 krasis.server INFO HCS GPU cuda:1: 15817 MB free, reserved=1218 MB (inference=706 + margin=512), budget=11965 MB (7735 max experts)
2026-02-21 01:11:14,469 krasis.gpu_prefill INFO HCS state cleared.
2026-02-21 01:11:14,480 krasis.gpu_prefill INFO Loaded heatmap from /home/main/.krasis/models/Qwen3-Coder-Next/.krasis_cache/auto_heatmap.json: 15923 entries
2026-02-21 01:11:14,484 krasis.gpu_prefill INFO HCS unified VRAM budget: 2 devices, 1.6 MB/expert, per-device max experts: {'cuda:0': 3545, 'cuda:1': 7734}, total max: 11279
2026-02-21 01:11:14,488 krasis.gpu_prefill INFO HCS assignment check: device 0 (cuda:0) ‚Üí 3545 experts (budget: 3545)
2026-02-21 01:11:14,488 krasis.gpu_prefill INFO HCS assignment check: device 1 (cuda:1) ‚Üí 7734 experts (budget: 7734)
2026-02-21 01:11:14,489 krasis.gpu_prefill INFO HCS pre-load: cuda:0 allocated=5363 MB, free=9323 MB
2026-02-21 01:11:14,489 krasis.gpu_prefill INFO HCS pre-load: cuda:1 allocated=0 MB, free=15817 MB
2026-02-21 01:11:15,082 krasis.gpu_prefill INFO HCS load L0: total=433 MB | dev0: alloc=5511MB free=9157MB loaded=156MB(96exp) | dev1: alloc=266MB free=15537MB loaded=277MB(171exp)
2026-02-21 01:11:17,856 krasis.gpu_prefill INFO HCS load L6: total=2415 MB | dev0: alloc=6233MB free=8435MB loaded=907MB(559exp) | dev1: alloc=1447MB free=14347MB loaded=1508MB(930exp)
2026-02-21 01:11:20,376 krasis.gpu_prefill INFO HCS load L12: total=4208 MB | dev0: alloc=6970MB free=7701MB loaded=1674MB(1032exp) | dev1: alloc=2430MB free=13371MB loaded=2534MB(1562exp)
2026-02-21 01:11:23,183 krasis.gpu_prefill INFO HCS load L18: total=6203 MB | dev0: alloc=7692MB free=6977MB loaded=2425MB(1495exp) | dev1: alloc=3623MB free=12173MB loaded=3778MB(2329exp)
2026-02-21 01:11:26,299 krasis.gpu_prefill INFO HCS load L24: total=8405 MB | dev0: alloc=8398MB free=6269MB loaded=3156MB(1946exp) | dev1: alloc=5030MB free=10767MB loaded=5249MB(3236exp)
2026-02-21 01:11:29,942 krasis.gpu_prefill INFO HCS load L30: total=10981 MB | dev0: alloc=9089MB free=5577MB loaded=3872MB(2387exp) | dev1: alloc=6810MB free=8979MB loaded=7109MB(4383exp)
2026-02-21 01:11:33,889 krasis.gpu_prefill INFO HCS load L36: total=13763 MB | dev0: alloc=9768MB free=4897MB loaded=4576MB(2821exp) | dev1: alloc=8798MB free=6985MB loaded=9187MB(5664exp)
2026-02-21 01:11:37,567 krasis.gpu_prefill INFO HCS load L42: total=16387 MB | dev0: alloc=10401MB free=4279MB loaded=5234MB(3227exp) | dev1: alloc=10681MB free=5095MB loaded=11153MB(6876exp)
2026-02-21 01:11:40,213 krasis.gpu_prefill INFO HCS load L47: total=18295 MB | dev0: alloc=10901MB free=3771MB loaded=5750MB(3545exp) | dev1: alloc=12014MB free=3761MB loaded=12545MB(7734exp)
2026-02-21 01:11:40,570 krasis.gpu_prefill INFO hot_cached_static initialized: 11279 experts across 2 devices, 18294.7 MB in 25.72s. Counts: {'cuda:0': 3545, 'cuda:1': 7734}
2026-02-21 01:11:40,635 krasis.gpu_prefill INFO Multi-GPU CUDA graphs: cuda:0 captured 48 layers
2026-02-21 01:11:40,735 krasis.gpu_prefill INFO Multi-GPU CUDA graphs: cuda:1 captured 48 layers
2026-02-21 01:11:40,735 krasis.gpu_prefill INFO Multi-GPU CUDA graphs captured: 96 total across 2 devices
2026-02-21 01:11:40,764 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:11:40,843 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11810.5 MB)
2026-02-21 01:11:40,846 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13014.0 MB)
2026-02-21 01:11:41,197 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11938.4 MB)
2026-02-21 01:11:41,198 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:41,542 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11939.6 MB)
2026-02-21 01:11:41,542 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:41,889 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11941.8 MB)
2026-02-21 01:11:41,890 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:42,177 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11941.8 MB)
2026-02-21 01:11:42,178 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:42,522 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11944.9 MB)
2026-02-21 01:11:42,526 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:42,873 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11947.1 MB)
2026-02-21 01:11:42,873 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:43,219 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11948.7 MB)
2026-02-21 01:11:43,223 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:43,513 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11948.7 MB)
2026-02-21 01:11:43,516 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:43,863 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11951.9 MB)
2026-02-21 01:11:43,867 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:44,212 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11953.1 MB)
2026-02-21 01:11:44,215 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:44,563 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11954.3 MB)
2026-02-21 01:11:44,566 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:44,857 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11954.3 MB)
2026-02-21 01:11:44,861 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:45,207 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11956.4 MB)
2026-02-21 01:11:45,207 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:45,552 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11958.6 MB)
2026-02-21 01:11:45,553 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:45,900 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11961.7 MB)
2026-02-21 01:11:45,900 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:46,190 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11961.7 MB)
2026-02-21 01:11:46,191 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:46,536 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11961.9 MB)
2026-02-21 01:11:46,536 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:46,884 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11966.1 MB)
2026-02-21 01:11:46,887 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:47,234 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11968.2 MB)
2026-02-21 01:11:47,237 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:47,528 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11967.2 MB)
2026-02-21 01:11:47,528 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:47,876 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11970.4 MB)
2026-02-21 01:11:47,876 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:48,221 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11970.6 MB)
2026-02-21 01:11:48,223 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:48,567 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11975.2 MB)
2026-02-21 01:11:48,568 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:48,858 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11974.2 MB)
2026-02-21 01:11:48,859 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:49,204 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11976.4 MB)
2026-02-21 01:11:49,204 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:49,552 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11978.5 MB)
2026-02-21 01:11:49,555 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:49,905 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11981.7 MB)
2026-02-21 01:11:49,905 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:50,196 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11980.7 MB)
2026-02-21 01:11:50,197 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:50,544 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11982.9 MB)
2026-02-21 01:11:50,545 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:50,893 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11985.0 MB)
2026-02-21 01:11:50,893 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:51,241 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11988.2 MB)
2026-02-21 01:11:51,245 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:51,536 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11987.2 MB)
2026-02-21 01:11:51,536 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:51,885 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11990.3 MB)
2026-02-21 01:11:51,885 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:52,233 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11991.5 MB)
2026-02-21 01:11:52,234 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:52,583 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11994.2 MB)
2026-02-21 01:11:52,586 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:52,877 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11994.2 MB)
2026-02-21 01:11:52,877 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:53,225 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:53,226 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11996.3 MB)
2026-02-21 01:11:53,575 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11998.5 MB)
2026-02-21 01:11:53,578 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:53,928 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12000.7 MB)
2026-02-21 01:11:53,931 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:54,224 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11999.7 MB)
2026-02-21 01:11:54,226 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:54,574 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12002.8 MB)
2026-02-21 01:11:54,578 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:54,926 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12005.0 MB)
2026-02-21 01:11:54,930 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:55,278 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12006.2 MB)
2026-02-21 01:11:55,282 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:55,572 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12007.1 MB)
2026-02-21 01:11:55,572 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:55,921 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12009.3 MB)
2026-02-21 01:11:55,924 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:56,273 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12010.5 MB)
2026-02-21 01:11:56,276 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:56,623 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 12013.6 MB)
2026-02-21 01:11:56,627 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13056.3 MB)
2026-02-21 01:11:56,983 krasis.gpu_prefill INFO GPU validation PASS: 3545 experts, 2707 MB free after load, inference cost 1797 MB (peak 12699 MB, baseline 10901 MB)
2026-02-21 01:11:56,984 krasis.server INFO HCS ready: 11279 experts across 2 GPUs, margin=910 MB (free=2707, cost=1797). Counts: {'cuda:0': 3545, 'cuda:1': 7734}
2026-02-21 01:11:57,136 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:11:57,136 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-21 01:11:57,225 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 11768.6 MB)
2026-02-21 01:11:57,228 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 13014.0 MB)
2026-02-21 01:12:02,421 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:12:02,422 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-21 01:12:02,500 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11785.6 MB)
2026-02-21 01:12:02,503 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13014.0 MB)
2026-02-21 01:12:07,172 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:12:07,172 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-21 01:12:07,250 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11827.5 MB)
2026-02-21 01:12:07,253 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13014.0 MB)
2026-02-21 01:12:19,633 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:12:19,634 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-21 01:12:19,711 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11827.6 MB)
2026-02-21 01:12:19,715 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13014.0 MB)
2026-02-21 01:12:31,955 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:12:31,955 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-21 01:12:32,044 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 11827.6 MB)
2026-02-21 01:12:32,047 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 13014.0 MB)
2026-02-21 01:12:44,344 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:12:44,344 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-21 01:12:44,434 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 11785.6 MB)
2026-02-21 01:12:44,434 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.09s (GPU total: 13014.0 MB)
2026-02-21 01:12:55,655 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:12:55,655 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-21 01:12:55,733 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11785.6 MB)
2026-02-21 01:12:55,736 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13014.0 MB)
2026-02-21 01:13:06,387 krasis.model INFO HCS prefill: 48 MoE layers, 1-layer groups (maximize chunk size)
2026-02-21 01:13:06,388 krasis.model INFO DMA pipelining ENABLED (2 managers, 48 groups)
2026-02-21 01:13:06,465 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 11785.6 MB)
2026-02-21 01:13:06,468 krasis.gpu_prefill INFO Layer group loaded: 1 MoE layers = 415.2 MB in 0.08s (GPU total: 13014.0 MB)

[1m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  KRASIS BENCHMARK
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê[0m

[1m[36m‚ñ∏ Collecting system info[0m
  Model:    [1mQwen3-Coder-Next[0m
  GPUs:     3x NVIDIA RTX 2000 Ada Generation
  Strategy: gpu_decode (hot_cached_static)

[1m[36m‚ñ∏ Loading benchmark prompts[0m
  Prefill: 10,000 tokens
  Decode:  24 tokens

[1m[36m‚ñ∏ Warmup (2 short generations)[0m
  Warmup: 2 short generations...
  Warmup complete.

[1m[36m‚ñ∏ Running prefill benchmark (10,000 tokens, 3 runs)[0m
  Run 1: 801.9 tok/s, TTFT=12.47s
  Run 2: 811.4 tok/s, TTFT=12.32s
  Run 3: 807.2 tok/s, TTFT=12.39s
  [1mAverage: 806.8 tok/s, TTFT=12.39s[0m

[1m[36m‚ñ∏ Running decode benchmark (64 tokens, 3 runs)[0m
  Run 1: 9.12 tok/s (109.7ms/tok)
  Run 2: 9.12 tok/s (109.6ms/tok)
  Run 3: 9.18 tok/s (109.0ms/tok)
  [1mAverage: 9.14 tok/s (109.4ms/tok)[0m

[1m[36m‚ñ∏ Writing results[0m

[1m‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  BENCHMARK COMPLETE
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[0m
  Prefill: [32m[1m806.8 tok/s[0m  TTFT=12.39s
  Decode:  [32m[1m9.14 tok/s[0m  (109.4ms/tok)
  Log:     [2mbenchmarks/Qwen3-Coder-Next_native_2gpu_int4gpu_int4cpu.log[0m

